
  ___  ____  ____  ____  ____ ®
 /__    /   ____/   /   ____/      StataNow 19.5
___/   /   /___/   /   /___/       MP—Parallel Edition

 Statistics and Data Science       Copyright 1985-2025 StataCorp LLC
                                   StataCorp
                                   4905 Lakeway Drive
                                   College Station, Texas 77845 USA
                                   800-782-8272        https://www.stata.com
                                   979-696-4600        service@stata.com

Stata license: 22-user 8-core network, expiring 30 Jun 2026
Serial number: 501909306443
  Licensed to: Jeffrey Ohl
               University of Chicago

Notes:
      1. Stata is running in batch mode.
      2. Unicode is supported; see help unicode_advice.
      3. More than 2 billion observations are allowed; see help obs_advice.
      4. Maximum number of variables is set to 5,000 but can be increased;
          see help set_maxvar.

. do chicago_synth.do 

. /*
> Synthetic Control for Chicago PPLTT Effect on ChatGPT
> 
> Outcome: Set by $outcome_var from data/synth_config.do
>   - log_users: log(unique users) per ZIP3-month
>   - log_trans: log(transactions) per ZIP3-month
> 
> Covariates + two pre-period outcome means + pre-period price:
> - pct_college: % with bachelor's degree or higher
> - pct_hh_100k: % households earning $100k+
> - pct_young: % aged 18-34
> - median_age: median age
> - median_income: median household income
> - pct_stem: % in STEM occupations
> - pct_broadband: % with broadband internet
> - pre_mean_early: mean $outcome_var Mar-Jun 2023 (months 3-6)
> - pre_mean_late: mean $outcome_var Jul-Sep 2023 (months 7-9)
> - pre_median_price: mean of monthly median price Mar-Sep 2023
> 
> Treatment: ZIP3 606 (Chicago), October 2023 (month_num = 10)
> Pre-period: March-September 2023 (month_num = 3-9)
> */
. 
. clear all

. set more off

. 
. * Install synth if needed
. capture which synth

. if _rc != 0 {
.     ssc install synth, replace
. }

. 
. * Load config (outcome_var, outcome_label, outdir from Python)
. include "data/synth_config.do"

. * Auto-generated by export_synth_data.py
. * DO NOT EDIT - change settings in load_chatgpt_data.py
. 
. global outcome_var "log_trans"

. global outcome_label "Log Transactions"

. global outdir "/Users/jeffreyohl/Dropbox/LLM_PassThrough/output/trans/15to25/
> all_merchants"

. 
. 
. * Load data
. use "data/synth_panel.dta", clear

. 
. * Check data structure
. describe

Contains data from data/synth_panel.dta
 Observations:        17,485                  
    Variables:            22                  30 Jan 2026 15:09
-------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
zip3            str3    %3s                   
zip3_id         long    %12.0g                
month_num       long    %12.0g                
month_dt        double  %tc                   
n_users         long    %12.0g                
log_users       double  %10.0g                
n_trans         long    %12.0g                
log_trans       double  %10.0g                
users_pc        double  %10.0g                
total_spend     double  %10.0g                
median_price    double  %10.0g                
pre_median_pr~e double  %10.0g                
treated         long    %12.0g                
post            long    %12.0g                
pct_college     double  %10.0g                
pct_hh_100k     double  %10.0g                
pct_young       double  %10.0g                
median_age      double  %10.0g                
median_income   double  %10.0g                
pct_stem        double  %10.0g                
pct_broadband   double  %10.0g                
population      double  %10.0g                
-------------------------------------------------------------------------------
Sorted by: 

. summarize

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
        zip3 |          0
     zip3_id |     17,485    440.2205    255.2991          1        876
   month_num |     17,485    13.20749    6.023116          3         23
    month_dt |     17,485    2.02e+12    1.59e+10   1.99e+12   2.05e+12
     n_users |     17,485    90.47149    200.0445          1       3198
-------------+---------------------------------------------------------
   log_users |     17,485    3.123213    1.710801          0   8.070281
     n_trans |     17,485    92.48396    204.2191          1       3257
   log_trans |     17,485    3.145813    1.711576          0   8.088562
    users_pc |     17,485    .0001766    .0002217   1.85e-06   .0024738
 total_spend |     17,485    1885.142    4154.952         15   65076.97
-------------+---------------------------------------------------------
median_price |     17,485    20.45202     .819534         15      24.86
pre_median~e |     17,176    20.36435     .732681       15.5      23.33
     treated |     17,485     .001201     .034636          0          1
        post |     17,485    .6818988    .4657523          0          1
 pct_college |     17,485     .310016    .1150186   .0972528   .8548676
-------------+---------------------------------------------------------
 pct_hh_100k |     17,485    .3372465    .1109674   .0396692   .8626897
   pct_young |     17,485    .0941093    .0271152   .0431875   .4809448
  median_age |     17,485    39.95333    3.751253   24.82586    53.6492
median_inc~e |     17,485     74506.6     22077.3   20819.72   224908.8
    pct_stem |     17,485    .3829688      .08007   .1992126   .7600029
-------------+---------------------------------------------------------
pct_broadb~d |     17,485    .8635499    .0542823   .3588774   .9698406
  population |     17,485    395072.9    418016.7       7743    3201870

. 
. * Balance panel: keep only ZIP3s with all 21 months (3 to 23)
. bysort zip3_id: gen n_months = _N

. tab n_months

   n_months |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          2        0.01        0.01
          2 |          4        0.02        0.03
          3 |         15        0.09        0.12
          6 |         18        0.10        0.22
          7 |         21        0.12        0.34
          8 |         16        0.09        0.43
          9 |         54        0.31        0.74
         10 |        100        0.57        1.32
         11 |         44        0.25        1.57
         12 |         96        0.55        2.12
         13 |         78        0.45        2.56
         14 |        140        0.80        3.36
         15 |        105        0.60        3.96
         16 |         80        0.46        4.42
         17 |        238        1.36        5.78
         18 |        252        1.44        7.22
         19 |        228        1.30        8.53
         20 |        580        3.32       11.84
         21 |     15,414       88.16      100.00
------------+-----------------------------------
      Total |     17,485      100.00

. keep if n_months == 21
(2,071 observations deleted)

. drop n_months

. display "After balancing: " _N " observations"
After balancing: 15414 observations

. 
. * Find Chicago's numeric ID from the data
. summarize zip3_id if zip3 == "606", meanonly

. local treated_unit = r(mean)

. display "Chicago (ZIP3 606) has ID: `treated_unit'"
Chicago (ZIP3 606) has ID: 546

. 
. * Treatment starts October 2023 (month_num = 10)
. local treatment_time = 10

. 
. * Set panel structure
. tsset zip3_id month_num

Panel variable: zip3_id (strongly balanced)
 Time variable: month_num, 3 to 23
         Delta: 1 unit

. 
. * Create TWO pre-period means (early and late)
. * Early: Mar-Jun 2023 (months 3-6)
. * Late: Jul-Sep 2023 (months 7-9)
. bysort zip3_id: egen pre_early_tmp = mean($outcome_var) if inrange(month_num,
>  3, 6)
(12,478 missing values generated)

. bysort zip3_id: egen pre_mean_early = max(pre_early_tmp)

. drop pre_early_tmp

. 
. bysort zip3_id: egen pre_late_tmp = mean($outcome_var) if inrange(month_num, 
> 7, 9)
(13,212 missing values generated)

. bysort zip3_id: egen pre_mean_late = max(pre_late_tmp)

. drop pre_late_tmp

. 
. * List Chicago's covariates + pre-period means + pre-period price
. list zip3 pct_college pct_hh_100k pct_young median_age median_income ///
>     pct_stem pct_broadband pre_mean_early pre_mean_late pre_median_price ///
>     if zip3_id == `treated_unit' & month_num == 3

       +-----------------------------------------------------------------+
 9514. | zip3 | pct_col~e | pct_~100k | pct_young | media~ge | median~me |
       |  606 | .40964007 | .35064975 | .09827828 | 35.87647 | 73536.991 |
       |-----------------------------------------------------------------|
       |  pct_stem  | pct_bro~d  |  pre_me~y  |  pre_m~te  |  pre_med~e  |
       | .43149119  | .85220409  |  4.723479  |  5.092312  |  20.105714  |
       +-----------------------------------------------------------------+

. 
. * Output directory comes from synth_config.do ($outdir)
. 
. * Run synthetic control
. * KITCHEN SINK: All covariates + two pre-period outcome means + pre-period pr
> ice
. synth $outcome_var ///
>     pct_college pct_hh_100k pct_young ///
>     median_age median_income pct_stem pct_broadband ///
>     pre_mean_early pre_mean_late pre_median_price, ///
>     trunit(`treated_unit') trperiod(`treatment_time') ///
>     fig keep("$outdir/synth_results", replace)
-------------------------------------------------------------------------------
Synthetic Control Method for Comparative Case Studies
-------------------------------------------------------------------------------

First Step: Data Setup
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------
Data Setup successful
-------------------------------------------------------------------------------
                Treated Unit: 546
               Control Units: 1 2 3 4 5 6 7 9 10 11 12 13 14 15 16 17 18 20 21
                              22 23 24 25 27 28 29 30 31 32 33 34 35 36 38 39
                              41 43 44 45 48 49 51 52 53 54 55 56 57 58 59 60
                              61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 77
                              78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93
                              94 95 96 97 99 100 101 102 103 104 105 106 107
                              108 109 111 112 113 114 118 120 122 123 124 126
                              127 128 129 130 131 132 133 134 138 141 142 143
                              146 147 148 149 150 152 153 154 155 156 157 158
                              159 160 161 162 163 164 165 166 167 168 169 170
                              171 172 173 174 175 176 177 178 179 180 181 182
                              183 184 185 186 187 188 189 190 191 192 193 194
                              195 196 197 198 199 200 201 202 203 204 205 206
                              207 208 209 210 211 212 213 214 215 216 217 218
                              219 220 221 222 228 229 230 238 241 242 243 244
                              245 246 247 248 249 250 251 252 253 254 255 256
                              257 258 259 261 262 263 264 265 266 267 268 269
                              270 271 272 273 274 275 276 277 278 279 280 281
                              282 283 284 285 286 287 288 289 290 291 292 293
                              294 295 296 297 298 299 300 301 302 303 304 305
                              306 307 308 309 310 311 312 313 314 315 316 317
                              318 319 320 321 322 323 324 325 326 327 328 329
                              330 332 333 334 335 336 337 338 339 340 341 342
                              343 345 346 347 348 349 352 353 354 356 357 358
                              361 363 364 365 366 370 371 374 380 385 386 387
                              389 390 391 395 396 397 398 401 403 404 405 406
                              407 409 413 414 415 416 417 419 420 421 422 423
                              425 426 428 430 431 432 433 434 435 436 437 438
                              439 440 441 442 443 444 446 447 448 449 451 452
                              453 454 455 456 457 458 459 460 461 464 467 468
                              469 470 472 473 474 475 476 477 478 479 480 481
                              482 483 484 486 487 488 489 490 491 492 493 494
                              495 496 497 498 499 500 502 503 504 505 506 507
                              508 509 510 511 512 513 514 515 516 517 520 521
                              522 523 526 527 528 529 530 531 532 533 534 536
                              537 538 539 540 541 542 543 544 545 549 550 552
                              554 555 556 557 558 560 561 562 563 564 565 566
                              567 568 569 570 571 574 576 577 578 579 581 582
                              584 587 591 592 593 594 595 596 598 599 600 601
                              602 604 605 607 608 609 612 613 614 616 617 619
                              620 622 625 626 627 628 629 630 631 632 633 634
                              636 637 639 641 642 643 644 648 649 650 651 652
                              653 657 660 661 666 667 668 669 670 671 672 673
                              674 676 677 678 679 680 681 682 683 684 686 687
                              688 689 690 691 692 693 694 695 696 697 698 699
                              700 701 702 703 704 705 706 708 709 711 712 713
                              714 715 716 717 718 719 720 721 722 723 724 725
                              726 727 728 729 730 731 732 735 736 737 738 739
                              740 741 743 744 745 746 747 748 749 750 751 752
                              753 754 755 756 757 758 759 760 761 762 763 764
                              765 766 767 768 769 770 771 772 773 774 775 776
                              777 778 779 780 782 783 785 786 787 788 789 790
                              791 792 793 794 795 796 797 798 799 800 801 802
                              803 804 805 806 807 808 809 810 811 812 813 814
                              815 816 817 818 819 820 821 822 823 824 825 826
                              827 828 829 830 831 832 833 834 835 836 837 838
                              839 840 841 842 843 844 845 846 847 848 849 850
                              851 852 853 854 855 856 858 859 860 861 862 863
                              864 865 866 867 868 869 870 871 872 873 874 875
                              876
-------------------------------------------------------------------------------
          Dependent Variable: log_trans
  MSPE minimized for periods: 3 4 5 6 7 8 9
Results obtained for periods: 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21
                              22 23
-------------------------------------------------------------------------------
                  Predictors: pct_college pct_hh_100k pct_young median_age
                              median_income pct_stem pct_broadband
                              pre_mean_early pre_mean_late pre_median_price
-------------------------------------------------------------------------------
Unless period is specified
predictors are averaged over: 3 4 5 6 7 8 9
-------------------------------------------------------------------------------

Second Step: Run Optimization
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------
Optimization done
-------------------------------------------------------------------------------

Third Step: Obtain Results
-------------------------------------------------------------------------------
Loss: Root Mean Squared Prediction Error

---------------------
   RMSPE |  .0139883 
---------------------
-------------------------------------------------------------------------------
Unit Weights:

-----------------------
    Co_No | Unit_Weight
----------+------------
        1 |           0
        2 |           0
        3 |           0
        4 |           0
        5 |           0
        6 |           0
        7 |           0
        9 |           0
       10 |           0
       11 |           0
       12 |           0
       13 |           0
       14 |           0
       15 |           0
       16 |           0
       17 |           0
       18 |           0
       20 |           0
       21 |           0
       22 |           0
       23 |           0
       24 |           0
       25 |           0
       27 |           0
       28 |           0
       29 |           0
       30 |           0
       31 |           0
       32 |           0
       33 |           0
       34 |           0
       35 |           0
       36 |           0
       38 |           0
       39 |           0
       41 |           0
       43 |           0
       44 |           0
       45 |           0
       48 |           0
       49 |           0
       51 |           0
       52 |           0
       53 |           0
       54 |           0
       55 |           0
       56 |           0
       57 |           0
       58 |           0
       59 |           0
       60 |           0
       61 |           0
       62 |           0
       63 |           0
       64 |           0
       65 |           0
       66 |           0
       67 |           0
       68 |           0
       69 |           0
       70 |           0
       71 |           0
       72 |           0
       73 |           0
       74 |           0
       75 |        .005
       77 |           0
       78 |           0
       79 |           0
       80 |           0
       81 |           0
       82 |           0
       83 |           0
       84 |           0
       85 |           0
       86 |           0
       87 |           0
       88 |           0
       89 |           0
       90 |           0
       91 |           0
       92 |           0
       93 |           0
       94 |           0
       95 |           0
       96 |           0
       97 |           0
       99 |           0
      100 |           0
      101 |           0
      102 |           0
      103 |           0
      104 |           0
      105 |           0
      106 |           0
      107 |           0
      108 |           0
      109 |           0
      111 |           0
      112 |           0
      113 |           0
      114 |           0
      118 |           0
      120 |           0
      122 |           0
      123 |           0
      124 |           0
      126 |           0
      127 |           0
      128 |           0
      129 |           0
      130 |           0
      131 |           0
      132 |           0
      133 |           0
      134 |           0
      138 |           0
      141 |           0
      142 |           0
      143 |           0
      146 |           0
      147 |           0
      148 |           0
      149 |           0
      150 |           0
      152 |           0
      153 |           0
      154 |           0
      155 |           0
      156 |           0
      157 |           0
      158 |           0
      159 |           0
      160 |           0
      161 |           0
      162 |           0
      163 |           0
      164 |           0
      165 |           0
      166 |           0
      167 |           0
      168 |           0
      169 |           0
      170 |           0
      171 |           0
      172 |           0
      173 |           0
      174 |           0
      175 |           0
      176 |           0
      177 |           0
      178 |           0
      179 |           0
      180 |           0
      181 |           0
      182 |           0
      183 |           0
      184 |           0
      185 |           0
      186 |           0
      187 |           0
      188 |           0
      189 |           0
      190 |           0
      191 |           0
      192 |           0
      193 |           0
      194 |           0
      195 |           0
      196 |           0
      197 |           0
      198 |           0
      199 |           0
      200 |           0
      201 |           0
      202 |           0
      203 |           0
      204 |           0
      205 |           0
      206 |           0
      207 |           0
      208 |           0
      209 |           0
      210 |           0
      211 |           0
      212 |           0
      213 |           0
      214 |           0
      215 |           0
      216 |           0
      217 |           0
      218 |           0
      219 |           0
      220 |           0
      221 |           0
      222 |           0
      228 |           0
      229 |           0
      230 |           0
      238 |           0
      241 |           0
      242 |           0
      243 |           0
      244 |           0
      245 |           0
      246 |           0
      247 |           0
      248 |           0
      249 |           0
      250 |           0
      251 |           0
      252 |           0
      253 |           0
      254 |           0
      255 |           0
      256 |           0
      257 |           0
      258 |           0
      259 |        .076
      261 |           0
      262 |           0
      263 |           0
      264 |           0
      265 |           0
      266 |           0
      267 |           0
      268 |           0
      269 |           0
      270 |           0
      271 |           0
      272 |           0
      273 |           0
      274 |        .262
      275 |           0
      276 |           0
      277 |           0
      278 |           0
      279 |           0
      280 |           0
      281 |           0
      282 |           0
      283 |           0
      284 |           0
      285 |           0
      286 |           0
      287 |           0
      288 |           0
      289 |           0
      290 |           0
      291 |           0
      292 |           0
      293 |           0
      294 |           0
      295 |           0
      296 |           0
      297 |           0
      298 |           0
      299 |           0
      300 |           0
      301 |           0
      302 |           0
      303 |           0
      304 |           0
      305 |           0
      306 |           0
      307 |           0
      308 |           0
      309 |           0
      310 |           0
      311 |           0
      312 |           0
      313 |           0
      314 |           0
      315 |           0
      316 |           0
      317 |           0
      318 |           0
      319 |           0
      320 |           0
      321 |           0
      322 |           0
      323 |           0
      324 |           0
      325 |           0
      326 |           0
      327 |           0
      328 |           0
      329 |           0
      330 |           0
      332 |           0
      333 |           0
      334 |           0
      335 |           0
      336 |           0
      337 |           0
      338 |           0
      339 |           0
      340 |           0
      341 |           0
      342 |           0
      343 |           0
      345 |           0
      346 |           0
      347 |           0
      348 |           0
      349 |           0
      352 |           0
      353 |           0
      354 |           0
      356 |           0
      357 |           0
      358 |           0
      361 |           0
      363 |           0
      364 |           0
      365 |           0
      366 |           0
      370 |           0
      371 |           0
      374 |           0
      380 |           0
      385 |           0
      386 |           0
      387 |           0
      389 |           0
      390 |           0
      391 |           0
      395 |           0
      396 |           0
      397 |           0
      398 |           0
      401 |           0
      403 |           0
      404 |           0
      405 |           0
      406 |           0
      407 |           0
      409 |           0
      413 |           0
      414 |           0
      415 |           0
      416 |           0
      417 |           0
      419 |           0
      420 |           0
      421 |           0
      422 |           0
      423 |           0
      425 |           0
      426 |           0
      428 |           0
      430 |           0
      431 |           0
      432 |           0
      433 |           0
      434 |           0
      435 |           0
      436 |           0
      437 |           0
      438 |           0
      439 |           0
      440 |           0
      441 |           0
      442 |           0
      443 |           0
      444 |           0
      446 |           0
      447 |           0
      448 |           0
      449 |           0
      451 |           0
      452 |           0
      453 |           0
      454 |           0
      455 |           0
      456 |           0
      457 |           0
      458 |           0
      459 |           0
      460 |           0
      461 |           0
      464 |           0
      467 |           0
      468 |           0
      469 |           0
      470 |           0
      472 |           0
      473 |           0
      474 |           0
      475 |           0
      476 |           0
      477 |           0
      478 |           0
      479 |           0
      480 |           0
      481 |           0
      482 |           0
      483 |           0
      484 |           0
      486 |           0
      487 |           0
      488 |           0
      489 |           0
      490 |           0
      491 |           0
      492 |           0
      493 |           0
      494 |           0
      495 |           0
      496 |           0
      497 |           0
      498 |           0
      499 |           0
      500 |           0
      502 |           0
      503 |           0
      504 |           0
      505 |           0
      506 |           0
      507 |           0
      508 |           0
      509 |           0
      510 |           0
      511 |           0
      512 |           0
      513 |           0
      514 |           0
      515 |           0
      516 |           0
      517 |           0
      520 |           0
      521 |           0
      522 |           0
      523 |           0
      526 |           0
      527 |           0
      528 |           0
      529 |        .079
      530 |           0
      531 |           0
      532 |           0
      533 |           0
      534 |           0
      536 |           0
      537 |           0
      538 |           0
      539 |           0
      540 |           0
      541 |           0
      542 |           0
      543 |           0
      544 |           0
      545 |           0
      549 |           0
      550 |           0
      552 |           0
      554 |           0
      555 |           0
      556 |           0
      557 |           0
      558 |           0
      560 |           0
      561 |           0
      562 |           0
      563 |           0
      564 |           0
      565 |           0
      566 |           0
      567 |           0
      568 |           0
      569 |           0
      570 |           0
      571 |           0
      574 |           0
      576 |           0
      577 |           0
      578 |           0
      579 |           0
      581 |           0
      582 |           0
      584 |           0
      587 |           0
      591 |           0
      592 |           0
      593 |           0
      594 |           0
      595 |           0
      596 |           0
      598 |           0
      599 |           0
      600 |           0
      601 |           0
      602 |           0
      604 |           0
      605 |           0
      607 |           0
      608 |           0
      609 |           0
      612 |           0
      613 |           0
      614 |           0
      616 |           0
      617 |           0
      619 |           0
      620 |           0
      622 |           0
      625 |           0
      626 |        .058
      627 |           0
      628 |           0
      629 |           0
      630 |           0
      631 |           0
      632 |           0
      633 |           0
      634 |           0
      636 |           0
      637 |           0
      639 |           0
      641 |           0
      642 |           0
      643 |           0
      644 |           0
      648 |           0
      649 |           0
      650 |           0
      651 |           0
      652 |           0
      653 |           0
      657 |           0
      660 |           0
      661 |           0
      666 |           0
      667 |           0
      668 |           0
      669 |           0
      670 |           0
      671 |           0
      672 |           0
      673 |           0
      674 |           0
      676 |           0
      677 |           0
      678 |           0
      679 |           0
      680 |           0
      681 |           0
      682 |           0
      683 |           0
      684 |           0
      686 |           0
      687 |           0
      688 |           0
      689 |           0
      690 |           0
      691 |           0
      692 |           0
      693 |           0
      694 |           0
      695 |           0
      696 |           0
      697 |           0
      698 |           0
      699 |           0
      700 |           0
      701 |           0
      702 |           0
      703 |           0
      704 |           0
      705 |           0
      706 |           0
      708 |           0
      709 |           0
      711 |           0
      712 |           0
      713 |           0
      714 |           0
      715 |           0
      716 |           0
      717 |           0
      718 |        .018
      719 |           0
      720 |           0
      721 |           0
      722 |           0
      723 |           0
      724 |           0
      725 |           0
      726 |           0
      727 |           0
      728 |           0
      729 |           0
      730 |           0
      731 |           0
      732 |           0
      735 |           0
      736 |           0
      737 |           0
      738 |           0
      739 |        .022
      740 |           0
      741 |        .041
      743 |           0
      744 |           0
      745 |           0
      746 |           0
      747 |           0
      748 |           0
      749 |           0
      750 |           0
      751 |           0
      752 |           0
      753 |           0
      754 |           0
      755 |           0
      756 |           0
      757 |           0
      758 |           0
      759 |           0
      760 |           0
      761 |           0
      762 |           0
      763 |           0
      764 |           0
      765 |           0
      766 |           0
      767 |           0
      768 |        .049
      769 |           0
      770 |           0
      771 |           0
      772 |           0
      773 |           0
      774 |           0
      775 |           0
      776 |           0
      777 |           0
      778 |           0
      779 |           0
      780 |           0
      782 |           0
      783 |           0
      785 |           0
      786 |           0
      787 |           0
      788 |           0
      789 |         .39
      790 |           0
      791 |           0
      792 |           0
      793 |           0
      794 |           0
      795 |           0
      796 |           0
      797 |           0
      798 |           0
      799 |           0
      800 |           0
      801 |           0
      802 |           0
      803 |           0
      804 |           0
      805 |           0
      806 |           0
      807 |           0
      808 |           0
      809 |           0
      810 |           0
      811 |           0
      812 |           0
      813 |           0
      814 |           0
      815 |           0
      816 |           0
      817 |           0
      818 |           0
      819 |           0
      820 |           0
      821 |           0
      822 |           0
      823 |           0
      824 |           0
      825 |           0
      826 |           0
      827 |           0
      828 |           0
      829 |           0
      830 |           0
      831 |           0
      832 |           0
      833 |           0
      834 |           0
      835 |           0
      836 |           0
      837 |           0
      838 |           0
      839 |           0
      840 |           0
      841 |           0
      842 |           0
      843 |           0
      844 |           0
      845 |           0
      846 |           0
      847 |           0
      848 |           0
      849 |           0
      850 |           0
      851 |           0
      852 |           0
      853 |           0
      854 |           0
      855 |           0
      856 |           0
      858 |           0
      859 |           0
      860 |           0
      861 |           0
      862 |           0
      863 |           0
      864 |           0
      865 |           0
      866 |           0
      867 |           0
      868 |           0
      869 |           0
      870 |           0
      871 |           0
      872 |           0
      873 |           0
      874 |           0
      875 |           0
      876 |           0
-----------------------
-------------------------------------------------------------------------------
Predictor Balance:

------------------------------------------------------
                               |   Treated  Synthetic 
-------------------------------+----------------------
                   pct_college |  .4096401    .409394 
                   pct_hh_100k |  .3506498   .3504943 
                     pct_young |  .0982783   .0988824 
                    median_age |  35.87647   35.92072 
                 median_income |  73536.99   73602.86 
                      pct_stem |  .4314912   .4316303 
                 pct_broadband |  .8522041   .8525429 
                pre_mean_early |  4.723479   4.724279 
                 pre_mean_late |  5.092312   5.093182 
              pre_median_price |  20.10571   20.12054 
------------------------------------------------------
-------------------------------------------------------------------------------

. 
. * The output includes:
. * - Donor weights
. * - Covariate balance table
. * - Pre/post treatment gaps
. 
. * Save results graph
. graph export "$outdir/chicago_synth_stata.png", replace width(1200)
file /Users/jeffreyohl/Dropbox/LLM_PassThrough/output/trans/15to25/all_merchant
> s/chicago_synth_stata.png written in PNG format

. 
. * Display treatment effects
. * synth stores results in e()
. matrix list e(Y_treated)

e(Y_treated)[21,1]
          546
 3  4.4188406
 4  4.7095302
 5  4.8751973
 6  4.8903491
 7  5.0172798
 8  5.1179938
 9  5.1416636
10   5.288267
11  5.3612922
12  5.4638318
13  5.5645204
14  5.6167711
15  5.6835798
16  5.7430032
17  5.7776523
18  5.7807435
19  5.8260001
20  5.8636312
21  5.9401713
22  6.0210233
23  6.1025586

. matrix list e(Y_synthetic)

e(Y_synthetic)[21,1]
           c1
 3  4.4165816
 4  4.7128153
 5  4.8756501
 6  4.8920706
 7  5.0275782
 8  5.0895026
 9  5.1624661
10  5.2894747
11  5.3353325
12  5.4908724
13  5.6103879
14  5.6804969
15  5.7781405
16  5.8467738
17  5.8872361
18  5.9340914
19  5.9642955
20   5.971539
21  6.1296135
22  6.2450744
23   6.302585

. 
. * ===========================================================================
> ==
. * SAVE DONOR WEIGHTS WITH ZIP3 CODES
. * (Must do this BEFORE any preserve/restore that would clear e() results)
. * ===========================================================================
> ==
. 
. * Get the weight matrix from synth
. matrix W = e(W_weights)

. local nrows = rowsof(W)

. 
. * Build a dataset with unit IDs and weights
. preserve

. clear

. set obs `nrows'
Number of observations (_N) was 0, now 733.

. gen zip3_id = .
(733 missing values generated)

. gen weight = .
(733 missing values generated)

. 
. * Fill in from the matrix - row names are the unit IDs
. local rnames : rowfullnames W

. local i = 1

. foreach rn of local rnames {
  2.     quietly replace zip3_id = `rn' in `i'
  3.     quietly replace weight = W[`i', 1] in `i'
  4.     local ++i
  5. }

. 
. * Keep only positive weights
. keep if weight > 0.001
(0 observations deleted)

. tempfile weights_temp

. save `weights_temp'
file /var/folders/g9/ggrmf_5j6tx4rv5qdhs0slq40000gn/T//St25745.000002 saved
    as .dta format

. restore

. 
. * Merge with main data to get ZIP3 codes
. preserve

. keep zip3_id zip3

. duplicates drop

Duplicates in terms of all variables

(14,680 observations deleted)

. merge 1:1 zip3_id using `weights_temp', keep(match) nogen
(variable zip3_id was long, now double to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                               733  
    -----------------------------------------

. 
. * Sort by weight descending
. gsort -weight

. 
. * Display top donors
. list zip3 zip3_id weight, sep(0)

     +-------------------------+
     | zip3   zip3_id   weight |
     |-------------------------|
  1. |  999       876      876 |
  2. |  998       875      875 |
  3. |  997       874      874 |
  4. |  996       873      873 |
  5. |  995       872      872 |
  6. |  994       871      871 |
  7. |  993       870      870 |
  8. |  992       869      869 |
  9. |  991       868      868 |
 10. |  990       867      867 |
 11. |  989       866      866 |
 12. |  988       865      865 |
 13. |  986       864      864 |
 14. |  985       863      863 |
 15. |  984       862      862 |
 16. |  983       861      861 |
 17. |  982       860      860 |
 18. |  981       859      859 |
 19. |  980       858      858 |
 20. |  978       856      856 |
 21. |  977       855      855 |
 22. |  976       854      854 |
 23. |  975       853      853 |
 24. |  974       852      852 |
 25. |  973       851      851 |
 26. |  972       850      850 |
 27. |  971       849      849 |
 28. |  970       848      848 |
 29. |  968       847      847 |
 30. |  967       846      846 |
 31. |  961       845      845 |
 32. |  960       844      844 |
 33. |  959       843      843 |
 34. |  958       842      842 |
 35. |  957       841      841 |
 36. |  956       840      840 |
 37. |  955       839      839 |
 38. |  954       838      838 |
 39. |  953       837      837 |
 40. |  952       836      836 |
 41. |  951       835      835 |
 42. |  950       834      834 |
 43. |  949       833      833 |
 44. |  948       832      832 |
 45. |  947       831      831 |
 46. |  946       830      830 |
 47. |  945       829      829 |
 48. |  944       828      828 |
 49. |  943       827      827 |
 50. |  941       826      826 |
 51. |  940       825      825 |
 52. |  939       824      824 |
 53. |  937       823      823 |
 54. |  936       822      822 |
 55. |  935       821      821 |
 56. |  934       820      820 |
 57. |  933       819      819 |
 58. |  932       818      818 |
 59. |  931       817      817 |
 60. |  930       816      816 |
 61. |  928       815      815 |
 62. |  927       814      814 |
 63. |  926       813      813 |
 64. |  925       812      812 |
 65. |  924       811      811 |
 66. |  923       810      810 |
 67. |  922       809      809 |
 68. |  921       808      808 |
 69. |  920       807      807 |
 70. |  919       806      806 |
 71. |  918       805      805 |
 72. |  917       804      804 |
 73. |  916       803      803 |
 74. |  915       802      802 |
 75. |  914       801      801 |
 76. |  913       800      800 |
 77. |  912       799      799 |
 78. |  911       798      798 |
 79. |  910       797      797 |
 80. |  908       796      796 |
 81. |  907       795      795 |
 82. |  906       794      794 |
 83. |  905       793      793 |
 84. |  904       792      792 |
 85. |  903       791      791 |
 86. |  902       790      790 |
 87. |  900       789      789 |
 88. |  898       788      788 |
 89. |  897       787      787 |
 90. |  895       786      786 |
 91. |  894       785      785 |
 92. |  891       783      783 |
 93. |  890       782      782 |
 94. |  883       780      780 |
 95. |  882       779      779 |
 96. |  881       778      778 |
 97. |  880       777      777 |
 98. |  879       776      776 |
 99. |  878       775      775 |
100. |  877       774      774 |
101. |  875       773      773 |
102. |  874       772      772 |
103. |  873       771      771 |
104. |  871       770      770 |
105. |  870       769      769 |
106. |  865       768      768 |
107. |  864       767      767 |
108. |  863       766      766 |
109. |  860       765      765 |
110. |  859       764      764 |
111. |  857       763      763 |
112. |  856       762      762 |
113. |  855       761      761 |
114. |  853       760      760 |
115. |  852       759      759 |
116. |  851       758      758 |
117. |  850       757      757 |
118. |  847       756      756 |
119. |  846       755      755 |
120. |  845       754      754 |
121. |  844       753      753 |
122. |  843       752      752 |
123. |  841       751      751 |
124. |  840       750      750 |
125. |  838       749      749 |
126. |  837       748      748 |
127. |  836       747      747 |
128. |  835       746      746 |
129. |  834       745      745 |
130. |  833       744      744 |
131. |  832       743      743 |
132. |  830       741      741 |
133. |  829       740      740 |
134. |  828       739      739 |
135. |  827       738      738 |
136. |  826       737      737 |
137. |  825       736      736 |
138. |  824       735      735 |
139. |  820       732      732 |
140. |  816       731      731 |
141. |  815       730      730 |
142. |  814       729      729 |
143. |  813       728      728 |
144. |  812       727      727 |
145. |  811       726      726 |
146. |  810       725      725 |
147. |  809       724      724 |
148. |  808       723      723 |
149. |  807       722      722 |
150. |  806       721      721 |
151. |  805       720      720 |
152. |  804       719      719 |
153. |  803       718      718 |
154. |  802       717      717 |
155. |  801       716      716 |
156. |  800       715      715 |
157. |  799       714      714 |
158. |  798       713      713 |
159. |  797       712      712 |
160. |  796       711      711 |
161. |  794       709      709 |
162. |  793       708      708 |
163. |  791       706      706 |
164. |  790       705      705 |
165. |  789       704      704 |
166. |  788       703      703 |
167. |  787       702      702 |
168. |  786       701      701 |
169. |  785       700      700 |
170. |  784       699      699 |
171. |  783       698      698 |
172. |  782       697      697 |
173. |  781       696      696 |
174. |  780       695      695 |
175. |  779       694      694 |
176. |  778       693      693 |
177. |  777       692      692 |
178. |  776       691      691 |
179. |  775       690      690 |
180. |  774       689      689 |
181. |  773       688      688 |
182. |  770       687      687 |
183. |  769       686      686 |
184. |  767       684      684 |
185. |  766       683      683 |
186. |  765       682      682 |
187. |  764       681      681 |
188. |  763       680      680 |
189. |  762       679      679 |
190. |  761       678      678 |
191. |  760       677      677 |
192. |  759       676      676 |
193. |  757       674      674 |
194. |  756       673      673 |
195. |  755       672      672 |
196. |  754       671      671 |
197. |  752       670      670 |
198. |  751       669      669 |
199. |  750       668      668 |
200. |  749       667      667 |
201. |  748       666      666 |
202. |  741       661      661 |
203. |  740       660      660 |
204. |  737       657      657 |
205. |  731       653      653 |
206. |  730       652      652 |
207. |  729       651      651 |
208. |  728       650      650 |
209. |  727       649      649 |
210. |  726       648      648 |
211. |  722       644      644 |
212. |  721       643      643 |
213. |  720       642      642 |
214. |  719       641      641 |
215. |  717       639      639 |
216. |  714       637      637 |
217. |  713       636      636 |
218. |  711       634      634 |
219. |  710       633      633 |
220. |  708       632      632 |
221. |  707       631      631 |
222. |  706       630      630 |
223. |  705       629      629 |
224. |  704       628      628 |
225. |  703       627      627 |
226. |  701       626      626 |
227. |  700       625      625 |
228. |  691       622      622 |
229. |  689       620      620 |
230. |  688       619      619 |
231. |  686       617      617 |
232. |  685       616      616 |
233. |  683       614      614 |
234. |  681       613      613 |
235. |  680       612      612 |
236. |  677       609      609 |
237. |  676       608      608 |
238. |  675       607      607 |
239. |  673       605      605 |
240. |  672       604      604 |
241. |  670       602      602 |
242. |  668       601      601 |
243. |  667       600      600 |
244. |  666       599      599 |
245. |  665       598      598 |
246. |  662       596      596 |
247. |  661       595      595 |
248. |  660       594      594 |
249. |  658       593      593 |
250. |  657       592      592 |
251. |  656       591      591 |
252. |  652       587      587 |
253. |  648       584      584 |
254. |  646       582      582 |
255. |  645       581      581 |
256. |  641       579      579 |
257. |  640       578      578 |
258. |  639       577      577 |
259. |  638       576      576 |
260. |  636       574      574 |
261. |  633       571      571 |
262. |  631       570      570 |
263. |  630       569      569 |
264. |  629       568      568 |
265. |  628       567      567 |
266. |  627       566      566 |
267. |  626       565      565 |
268. |  625       564      564 |
269. |  624       563      563 |
270. |  623       562      562 |
271. |  622       561      561 |
272. |  620       560      560 |
273. |  618       558      558 |
274. |  617       557      557 |
275. |  616       556      556 |
276. |  615       555      555 |
277. |  614       554      554 |
278. |  612       552      552 |
279. |  610       550      550 |
280. |  609       549      549 |
281. |  605       545      545 |
282. |  604       544      544 |
283. |  603       543      543 |
284. |  602       542      542 |
285. |  601       541      541 |
286. |  600       540      540 |
287. |  599       539      539 |
288. |  598       538      538 |
289. |  597       537      537 |
290. |  596       536      536 |
291. |  594       534      534 |
292. |  593       533      533 |
293. |  592       532      532 |
294. |  591       531      531 |
295. |  590       530      530 |
296. |  588       529      529 |
297. |  587       528      528 |
298. |  586       527      527 |
299. |  585       526      526 |
300. |  582       523      523 |
301. |  581       522      522 |
302. |  580       521      521 |
303. |  577       520      520 |
304. |  574       517      517 |
305. |  573       516      516 |
306. |  572       515      515 |
307. |  571       514      514 |
308. |  570       513      513 |
309. |  567       512      512 |
310. |  566       511      511 |
311. |  565       510      510 |
312. |  564       509      509 |
313. |  563       508      508 |
314. |  562       507      507 |
315. |  561       506      506 |
316. |  560       505      505 |
317. |  559       504      504 |
318. |  558       503      503 |
319. |  557       502      502 |
320. |  554       500      500 |
321. |  553       499      499 |
322. |  551       498      498 |
323. |  550       497      497 |
324. |  549       496      496 |
325. |  548       495      495 |
326. |  547       494      494 |
327. |  546       493      493 |
328. |  545       492      492 |
329. |  544       491      491 |
330. |  543       490      490 |
331. |  542       489      489 |
332. |  541       488      488 |
333. |  540       487      487 |
334. |  539       486      486 |
335. |  537       484      484 |
336. |  535       483      483 |
337. |  534       482      482 |
338. |  532       481      481 |
339. |  531       480      480 |
340. |  530       479      479 |
341. |  528       478      478 |
342. |  527       477      477 |
343. |  526       476      476 |
344. |  525       475      475 |
345. |  524       474      474 |
346. |  523       473      473 |
347. |  522       472      472 |
348. |  520       470      470 |
349. |  516       469      469 |
350. |  515       468      468 |
351. |  514       467      467 |
352. |  511       464      464 |
353. |  507       461      461 |
354. |  506       460      460 |
355. |  505       459      459 |
356. |  504       458      458 |
357. |  503       457      457 |
358. |  502       456      456 |
359. |  501       455      455 |
360. |  500       454      454 |
361. |  499       453      453 |
362. |  498       452      452 |
363. |  497       451      451 |
364. |  495       449      449 |
365. |  494       448      448 |
366. |  493       447      447 |
367. |  492       446      446 |
368. |  490       444      444 |
369. |  489       443      443 |
370. |  488       442      442 |
371. |  487       441      441 |
372. |  486       440      440 |
373. |  485       439      439 |
374. |  484       438      438 |
375. |  483       437      437 |
376. |  482       436      436 |
377. |  481       435      435 |
378. |  480       434      434 |
379. |  479       433      433 |
380. |  478       432      432 |
381. |  477       431      431 |
382. |  476       430      430 |
383. |  474       428      428 |
384. |  472       426      426 |
385. |  471       425      425 |
386. |  469       423      423 |
387. |  468       422      422 |
388. |  467       421      421 |
389. |  466       420      420 |
390. |  465       419      419 |
391. |  463       417      417 |
392. |  462       416      416 |
393. |  461       415      415 |
394. |  460       414      414 |
395. |  458       413      413 |
396. |  454       409      409 |
397. |  452       407      407 |
398. |  451       406      406 |
399. |  450       405      405 |
400. |  449       404      404 |
401. |  448       403      403 |
402. |  446       401      401 |
403. |  443       398      398 |
404. |  442       397      397 |
405. |  441       396      396 |
406. |  440       395      395 |
407. |  436       391      391 |
408. |  435       390      390 |
409. |  434       389      389 |
410. |  432       387      387 |
411. |  431       386      386 |
412. |  430       385      385 |
413. |  423       380      380 |
414. |  413       374      374 |
415. |  410       371      371 |
416. |  409       370      370 |
417. |  405       366      366 |
418. |  404       365      365 |
419. |  403       364      364 |
420. |  402       363      363 |
421. |  400       361      361 |
422. |  396       358      358 |
423. |  395       357      357 |
424. |  394       356      356 |
425. |  392       354      354 |
426. |  391       353      353 |
427. |  390       352      352 |
428. |  387       349      349 |
429. |  386       348      348 |
430. |  385       347      347 |
431. |  384       346      346 |
432. |  383       345      345 |
433. |  381       343      343 |
434. |  380       342      342 |
435. |  379       341      341 |
436. |  378       340      340 |
437. |  377       339      339 |
438. |  376       338      338 |
439. |  374       337      337 |
440. |  373       336      336 |
441. |  372       335      335 |
442. |  371       334      334 |
443. |  370       333      333 |
444. |  368       332      332 |
445. |  366       330      330 |
446. |  365       329      329 |
447. |  364       328      328 |
448. |  363       327      327 |
449. |  362       326      326 |
450. |  361       325      325 |
451. |  360       324      324 |
452. |  359       323      323 |
453. |  358       322      322 |
454. |  357       321      321 |
455. |  356       320      320 |
456. |  355       319      319 |
457. |  354       318      318 |
458. |  352       317      317 |
459. |  351       316      316 |
460. |  350       315      315 |
461. |  349       314      314 |
462. |  347       313      313 |
463. |  346       312      312 |
464. |  344       311      311 |
465. |  342       310      310 |
466. |  341       309      309 |
467. |  339       308      308 |
468. |  338       307      307 |
469. |  337       306      306 |
470. |  336       305      305 |
471. |  335       304      304 |
472. |  334       303      303 |
473. |  333       302      302 |
474. |  331       301      301 |
475. |  330       300      300 |
476. |  329       299      299 |
477. |  328       298      298 |
478. |  327       297      297 |
479. |  326       296      296 |
480. |  325       295      295 |
481. |  324       294      294 |
482. |  323       293      293 |
483. |  322       292      292 |
484. |  321       291      291 |
485. |  320       290      290 |
486. |  319       289      289 |
487. |  318       288      288 |
488. |  317       287      287 |
489. |  316       286      286 |
490. |  315       285      285 |
491. |  314       284      284 |
492. |  313       283      283 |
493. |  312       282      282 |
494. |  310       281      281 |
495. |  309       280      280 |
496. |  308       279      279 |
497. |  307       278      278 |
498. |  306       277      277 |
499. |  305       276      276 |
500. |  304       275      275 |
501. |  303       274      274 |
502. |  302       273      273 |
503. |  301       272      272 |
504. |  300       271      271 |
505. |  299       270      270 |
506. |  298       269      269 |
507. |  297       268      268 |
508. |  296       267      267 |
509. |  295       266      266 |
510. |  294       265      265 |
511. |  293       264      264 |
512. |  292       263      263 |
513. |  291       262      262 |
514. |  290       261      261 |
515. |  288       259      259 |
516. |  287       258      258 |
517. |  286       257      257 |
518. |  285       256      256 |
519. |  284       255      255 |
520. |  283       254      254 |
521. |  282       253      253 |
522. |  281       252      252 |
523. |  280       251      251 |
524. |  279       250      250 |
525. |  278       249      249 |
526. |  277       248      248 |
527. |  276       247      247 |
528. |  275       246      246 |
529. |  274       245      245 |
530. |  273       244      244 |
531. |  272       243      243 |
532. |  271       242      242 |
533. |  270       241      241 |
534. |  265       238      238 |
535. |  257       230      230 |
536. |  255       229      229 |
537. |  254       228      228 |
538. |  246       222      222 |
539. |  245       221      221 |
540. |  244       220      220 |
541. |  243       219      219 |
542. |  242       218      218 |
543. |  241       217      217 |
544. |  240       216      216 |
545. |  239       215      215 |
546. |  238       214      214 |
547. |  237       213      213 |
548. |  236       212      212 |
549. |  235       211      211 |
550. |  234       210      210 |
551. |  233       209      209 |
552. |  232       208      208 |
553. |  231       207      207 |
554. |  230       206      206 |
555. |  229       205      205 |
556. |  228       204      204 |
557. |  227       203      203 |
558. |  226       202      202 |
559. |  225       201      201 |
560. |  224       200      200 |
561. |  223       199      199 |
562. |  222       198      198 |
563. |  221       197      197 |
564. |  220       196      196 |
565. |  219       195      195 |
566. |  218       194      194 |
567. |  217       193      193 |
568. |  216       192      192 |
569. |  215       191      191 |
570. |  214       190      190 |
571. |  212       189      189 |
572. |  211       188      188 |
573. |  210       187      187 |
574. |  209       186      186 |
575. |  208       185      185 |
576. |  207       184      184 |
577. |  206       183      183 |
578. |  201       182      182 |
579. |  200       181      181 |
580. |  199       180      180 |
581. |  198       179      179 |
582. |  197       178      178 |
583. |  196       177      177 |
584. |  195       176      176 |
585. |  194       175      175 |
586. |  193       174      174 |
587. |  191       173      173 |
588. |  190       172      172 |
589. |  189       171      171 |
590. |  188       170      170 |
591. |  187       169      169 |
592. |  186       168      168 |
593. |  185       167      167 |
594. |  184       166      166 |
595. |  183       165      165 |
596. |  182       164      164 |
597. |  181       163      163 |
598. |  180       162      162 |
599. |  179       161      161 |
600. |  178       160      160 |
601. |  177       159      159 |
602. |  176       158      158 |
603. |  175       157      157 |
604. |  174       156      156 |
605. |  173       155      155 |
606. |  172       154      154 |
607. |  171       153      153 |
608. |  170       152      152 |
609. |  168       150      150 |
610. |  167       149      149 |
611. |  166       148      148 |
612. |  165       147      147 |
613. |  164       146      146 |
614. |  161       143      143 |
615. |  160       142      142 |
616. |  159       141      141 |
617. |  156       138      138 |
618. |  152       134      134 |
619. |  151       133      133 |
620. |  150       132      132 |
621. |  149       131      131 |
622. |  148       130      130 |
623. |  147       129      129 |
624. |  146       128      128 |
625. |  145       127      127 |
626. |  144       126      126 |
627. |  142       124      124 |
628. |  141       123      123 |
629. |  140       122      122 |
630. |  138       120      120 |
631. |  136       118      118 |
632. |  132       114      114 |
633. |  131       113      113 |
634. |  130       112      112 |
635. |  129       111      111 |
636. |  127       109      109 |
637. |  126       108      108 |
638. |  125       107      107 |
639. |  124       106      106 |
640. |  123       105      105 |
641. |  122       104      104 |
642. |  121       103      103 |
643. |  120       102      102 |
644. |  119       101      101 |
645. |  118       100      100 |
646. |  117        99       99 |
647. |  115        97       97 |
648. |  114        96       96 |
649. |  113        95       95 |
650. |  112        94       94 |
651. |  111        93       93 |
652. |  110        92       92 |
653. |  109        91       91 |
654. |  108        90       90 |
655. |  107        89       89 |
656. |  106        88       88 |
657. |  105        87       87 |
658. |  104        86       86 |
659. |  103        85       85 |
660. |  102        84       84 |
661. |  101        83       83 |
662. |  100        82       82 |
663. |  089        81       81 |
664. |  088        80       80 |
665. |  087        79       79 |
666. |  086        78       78 |
667. |  085        77       77 |
668. |  083        75       75 |
669. |  082        74       74 |
670. |  081        73       73 |
671. |  080        72       72 |
672. |  079        71       71 |
673. |  078        70       70 |
674. |  077        69       69 |
675. |  076        68       68 |
676. |  075        67       67 |
677. |  074        66       66 |
678. |  073        65       65 |
679. |  072        64       64 |
680. |  071        63       63 |
681. |  070        62       62 |
682. |  069        61       61 |
683. |  068        60       60 |
684. |  067        59       59 |
685. |  066        58       58 |
686. |  065        57       57 |
687. |  064        56       56 |
688. |  063        55       55 |
689. |  062        54       54 |
690. |  061        53       53 |
691. |  060        52       52 |
692. |  058        51       51 |
693. |  056        49       49 |
694. |  054        48       48 |
695. |  051        45       45 |
696. |  050        44       44 |
697. |  049        43       43 |
698. |  047        41       41 |
699. |  045        39       39 |
700. |  044        38       38 |
701. |  042        36       36 |
702. |  041        35       35 |
703. |  040        34       34 |
704. |  039        33       33 |
705. |  038        32       32 |
706. |  037        31       31 |
707. |  036        30       30 |
708. |  035        29       29 |
709. |  034        28       28 |
710. |  033        27       27 |
711. |  031        25       25 |
712. |  030        24       24 |
713. |  029        23       23 |
714. |  028        22       22 |
715. |  027        21       21 |
716. |  026        20       20 |
717. |  024        18       18 |
718. |  023        17       17 |
719. |  022        16       16 |
720. |  021        15       15 |
721. |  020        14       14 |
722. |  019        13       13 |
723. |  018        12       12 |
724. |  017        11       11 |
725. |  016        10       10 |
726. |  015         9        9 |
727. |  013         7        7 |
728. |  012         6        6 |
729. |  011         5        5 |
730. |  010         4        4 |
731. |  009         3        3 |
732. |  007         2        2 |
733. |  006         1        1 |
     +-------------------------+

. 
. * Save to CSV
. export delimited zip3 zip3_id weight using "$outdir/synth_donor_weights.csv",
>  replace
file /Users/jeffreyohl/Dropbox/LLM_PassThrough/output/trans/15to25/all_merchant
> s/synth_donor_weights.csv saved

. display "Saved donor weights to $outdir/synth_donor_weights.csv"
Saved donor weights to /Users/jeffreyohl/Dropbox/LLM_PassThrough/output/trans/1
> 5to25/all_merchants/synth_donor_weights.csv

. 
. restore

. 
. * ===========================================================================
> ==
. * COMPUTE AVERAGE TREATMENT GAPS
. * ===========================================================================
> ==
. preserve

. use "$outdir/synth_results.dta", clear

. gen gap = _Y_treated - _Y_synthetic
(712 missing values generated)

. summarize gap if _time >= `treatment_time'

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         gap |         14   -.1023477    .0749474  -.2240511   .0259597

. local post_gap = r(mean)

. display "Average post-treatment gap: `post_gap'"
Average post-treatment gap: -.1023476971396511

. summarize gap if _time < `treatment_time'

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         gap |          7     -.00083    .0150819  -.0208025   .0284912

. local pre_gap = r(mean)

. display "Average pre-treatment gap: `pre_gap'"
Average pre-treatment gap: -.0008299939134823

. restore

. 
end of do-file
