
  ___  ____  ____  ____  ____ ®
 /__    /   ____/   /   ____/      StataNow 19.5
___/   /   /___/   /   /___/       MP—Parallel Edition

 Statistics and Data Science       Copyright 1985-2025 StataCorp LLC
                                   StataCorp
                                   4905 Lakeway Drive
                                   College Station, Texas 77845 USA
                                   800-782-8272        https://www.stata.com
                                   979-696-4600        service@stata.com

Stata license: 22-user 8-core network, expiring 30 Jun 2026
Serial number: 501909306443
  Licensed to: Jeffrey Ohl
               University of Chicago

Notes:
      1. Stata is running in batch mode.
      2. Unicode is supported; see help unicode_advice.
      3. More than 2 billion observations are allowed; see help obs_advice.
      4. Maximum number of variables is set to 5,000 but can be increased;
          see help set_maxvar.

. do chicago_synth.do 

. /*
> Synthetic Control for Chicago PPLTT Effect on ChatGPT
> 
> Outcome: log(unique users) per ZIP3-month
> 
> Covariates + two pre-period outcome means + pre-period price:
> - pct_college: % with bachelor's degree or higher
> - pct_hh_100k: % households earning $100k+
> - pct_young: % aged 18-34
> - median_age: median age
> - median_income: median household income
> - pct_stem: % in STEM occupations
> - pct_broadband: % with broadband internet
> - pre_mean_early: mean log_users Mar-Jun 2023 (months 3-6)
> - pre_mean_late: mean log_users Jul-Sep 2023 (months 7-9)
> - pre_median_price: mean of monthly median price Mar-Sep 2023
> 
> Treatment: ZIP3 606 (Chicago), October 2023 (month_num = 10)
> Pre-period: March-September 2023 (month_num = 3-9)
> */
. 
. clear all

. set more off

. 
. * Install synth if needed
. capture which synth

. if _rc != 0 {
.     ssc install synth, replace
. }

. 
. * Load data
. use "data/synth_panel.dta", clear

. 
. * Check data structure
. describe

Contains data from data/synth_panel.dta
 Observations:        17,502                  
    Variables:            21                  30 Jan 2026 10:27
-------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
-------------------------------------------------------------------------------
zip3            str3    %3s                   
zip3_id         long    %12.0g                
month_num       long    %12.0g                
month_dt        double  %tc                   
n_users         long    %12.0g                
log_users       double  %10.0g                
users_pc        double  %10.0g                
n_trans         long    %12.0g                
total_spend     double  %10.0g                
median_price    double  %10.0g                
pre_median_pr~e double  %10.0g                
treated         long    %12.0g                
post            long    %12.0g                
pct_college     double  %10.0g                
pct_hh_100k     double  %10.0g                
pct_young       double  %10.0g                
median_age      double  %10.0g                
median_income   double  %10.0g                
pct_stem        double  %10.0g                
pct_broadband   double  %10.0g                
population      double  %10.0g                
-------------------------------------------------------------------------------
Sorted by: 

. summarize

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
        zip3 |          0
     zip3_id |     17,502    438.1162    254.2639          1        873
   month_num |     17,502    13.19763    6.029248          3         23
    month_dt |     17,502    2.02e+12    1.59e+10   1.99e+12   2.05e+12
     n_users |     17,502    96.45275     213.818          1       3413
-------------+---------------------------------------------------------
   log_users |     17,502    3.172108    1.722804          0   8.135347
    users_pc |     17,502    .0001876    .0002371   1.85e-06   .0026045
     n_trans |     17,502    98.57576    218.2289          1       3474
 total_spend |     17,502    2009.326    4439.933      15.02   69399.41
median_price |     17,502     20.4466    .8175849      15.02      24.98
-------------+---------------------------------------------------------
pre_median~e |     17,250    20.36512    .7197888       15.5      23.17
     treated |     17,502    .0011999    .0346192          0          1
        post |     17,502    .6806651    .4662323          0          1
 pct_college |     17,502    .3100626    .1149949   .0972528   .8548676
 pct_hh_100k |     17,502    .3371632    .1109772   .0396692   .8626897
-------------+---------------------------------------------------------
   pct_young |     17,502    .0941315    .0271549   .0431875   .4809448
  median_age |     17,502    39.96141     3.75922   24.82586    53.6492
median_inc~e |     17,502    74484.54    22080.61   20819.72   224908.8
    pct_stem |     17,502    .3830456    .0799999   .1992126   .7600029
pct_broadb~d |     17,502    .8632875    .0545474   .3588774   .9698406
-------------+---------------------------------------------------------
  population |     17,502    394742.6    417956.3       7743    3201870

. 
. * Balance panel: keep only ZIP3s with all 21 months (3 to 23)
. bysort zip3_id: gen n_months = _N

. tab n_months

   n_months |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          2        0.01        0.01
          2 |          4        0.02        0.03
          3 |          9        0.05        0.09
          4 |          8        0.05        0.13
          6 |         12        0.07        0.20
          8 |         40        0.23        0.43
          9 |         63        0.36        0.79
         10 |         50        0.29        1.07
         11 |         66        0.38        1.45
         12 |         48        0.27        1.73
         13 |         91        0.52        2.25
         14 |        112        0.64        2.89
         15 |         75        0.43        3.31
         16 |        160        0.91        4.23
         17 |        187        1.07        5.30
         18 |        234        1.34        6.63
         19 |        342        1.95        8.59
         20 |        480        2.74       11.33
         21 |     15,519       88.67      100.00
------------+-----------------------------------
      Total |     17,502      100.00

. keep if n_months == 21
(1,983 observations deleted)

. drop n_months

. display "After balancing: " _N " observations"
After balancing: 15519 observations

. 
. * Find Chicago's numeric ID from the data
. summarize zip3_id if zip3 == "606", meanonly

. local treated_unit = r(mean)

. display "Chicago (ZIP3 606) has ID: `treated_unit'"
Chicago (ZIP3 606) has ID: 544

. 
. * Treatment starts October 2023 (month_num = 10)
. local treatment_time = 10

. 
. * Set panel structure
. tsset zip3_id month_num

Panel variable: zip3_id (strongly balanced)
 Time variable: month_num, 3 to 23
         Delta: 1 unit

. 
. * Create TWO pre-period means (early and late)
. * Early: Mar-Jun 2023 (months 3-6)
. * Late: Jul-Sep 2023 (months 7-9)
. bysort zip3_id: egen pre_early_tmp = mean(log_users) if inrange(month_num, 3,
>  6)
(12,563 missing values generated)

. bysort zip3_id: egen pre_mean_early = max(pre_early_tmp)

. drop pre_early_tmp

. 
. bysort zip3_id: egen pre_late_tmp = mean(log_users) if inrange(month_num, 7, 
> 9)
(13,302 missing values generated)

. bysort zip3_id: egen pre_mean_late = max(pre_late_tmp)

. drop pre_late_tmp

. 
. * List Chicago's covariates + pre-period means + pre-period price
. list zip3 pct_college pct_hh_100k pct_young median_age median_income ///
>     pct_stem pct_broadband pre_mean_early pre_mean_late pre_median_price ///
>     if zip3_id == `treated_unit' & month_num == 3

       +-----------------------------------------------------------------+
 9619. | zip3 | pct_col~e | pct_~100k | pct_young | media~ge | median~me |
       |  606 | .40964007 | .35064975 | .09827828 | 35.87647 | 73536.991 |
       |-----------------------------------------------------------------|
       |  pct_stem  | pct_bro~d  |  pre_me~y  |  pre_m~te  |  pre_med~e  |
       | .43149119  | .85220409  |  4.767876  |  5.111015  |  20.079286  |
       +-----------------------------------------------------------------+

. 
. * Output directory (matches load_chatgpt_data.py settings)
. local outdir "/Users/jeffreyohl/Dropbox/LLM_PassThrough/output/unique_users/1
> 5to25/all_merchants"

. 
. * Run synthetic control
. * KITCHEN SINK: All covariates + two pre-period outcome means + pre-period pr
> ice
. synth log_users ///
>     pct_college pct_hh_100k pct_young ///
>     median_age median_income pct_stem pct_broadband ///
>     pre_mean_early pre_mean_late pre_median_price, ///
>     trunit(`treated_unit') trperiod(`treatment_time') ///
>     fig keep("`outdir'/synth_results", replace)
-------------------------------------------------------------------------------
Synthetic Control Method for Comparative Case Studies
-------------------------------------------------------------------------------

First Step: Data Setup
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------
Data Setup successful
-------------------------------------------------------------------------------
                Treated Unit: 544
               Control Units: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 20
                              21 22 23 24 25 27 28 29 30 31 32 33 34 35 36 38
                              39 41 43 44 45 46 47 48 49 51 52 53 54 55 56 57
                              58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73
                              74 75 77 78 79 80 81 82 83 84 85 86 87 88 89 90
                              91 92 93 94 95 96 97 99 100 101 102 103 104 106
                              107 108 109 111 112 113 114 118 120 122 123 124
                              126 127 128 129 130 131 132 133 134 138 141 142
                              146 147 148 149 150 152 153 154 155 156 157 158
                              159 160 161 162 163 164 165 166 167 168 169 170
                              171 172 173 174 175 176 177 178 179 180 181 182
                              183 184 185 186 187 188 189 190 191 192 193 194
                              195 196 197 198 199 200 201 202 203 204 205 206
                              207 208 209 210 211 212 213 214 215 216 217 218
                              219 220 221 222 224 228 229 230 237 240 241 242
                              243 244 245 246 247 248 249 250 251 252 253 254
                              255 256 257 258 260 261 262 263 264 265 266 267
                              268 269 270 271 272 273 274 275 276 277 278 279
                              280 281 282 283 284 285 286 287 288 289 290 291
                              292 293 294 295 296 297 298 299 300 301 302 303
                              304 305 306 307 308 309 310 311 312 313 314 315
                              316 317 318 319 320 321 322 323 324 325 326 327
                              328 329 331 332 333 334 335 336 337 338 339 340
                              341 342 343 344 345 346 347 348 351 352 353 355
                              356 357 358 360 362 363 364 365 369 370 373 379
                              384 385 386 388 389 390 394 395 396 397 398 400
                              402 403 404 405 406 408 411 412 413 414 415 417
                              418 419 420 421 423 424 426 428 429 430 431 432
                              433 434 435 436 437 438 439 440 441 442 444 445
                              446 447 449 450 451 452 453 454 455 456 457 458
                              459 462 465 466 467 468 470 471 472 473 474 475
                              476 477 478 479 480 481 482 484 485 486 487 488
                              489 490 491 492 493 494 495 496 497 498 500 501
                              502 503 504 505 506 507 508 509 510 511 512 513
                              514 515 518 519 520 521 524 525 526 527 528 529
                              530 531 532 534 535 536 537 538 539 540 541 542
                              543 546 547 549 550 551 552 553 554 555 557 558
                              559 560 562 563 564 565 566 567 568 571 573 574
                              575 576 578 579 580 581 583 584 588 589 590 591
                              592 593 595 596 597 599 601 602 604 605 607 609
                              610 611 613 614 616 617 619 622 623 624 625 626
                              627 628 629 630 631 633 634 636 638 639 640 641
                              644 645 646 647 648 649 650 657 658 663 665 666
                              667 668 669 670 671 673 674 675 676 677 678 679
                              680 681 683 684 685 686 687 688 689 690 691 692
                              693 694 695 696 697 698 699 700 701 702 703 705
                              706 708 709 710 711 712 713 714 715 716 717 718
                              719 720 721 722 723 724 725 726 727 728 729 732
                              733 734 735 736 737 738 740 741 742 743 744 745
                              746 747 748 749 750 751 752 753 754 755 756 757
                              758 759 760 761 762 763 764 765 766 767 768 769
                              770 771 772 773 774 775 776 777 779 780 782 783
                              784 785 786 787 788 789 790 791 792 793 794 795
                              796 797 798 799 800 801 802 803 804 805 806 807
                              808 809 810 811 812 813 814 815 816 817 818 819
                              820 821 822 823 824 825 826 827 828 829 830 831
                              832 833 834 835 836 837 838 839 840 841 842 843
                              844 845 846 847 848 849 850 851 852 853 855 856
                              857 858 859 860 861 862 863 864 865 866 867 868
                              869 870 871 872 873
-------------------------------------------------------------------------------
          Dependent Variable: log_users
  MSPE minimized for periods: 3 4 5 6 7 8 9
Results obtained for periods: 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21
                              22 23
-------------------------------------------------------------------------------
                  Predictors: pct_college pct_hh_100k pct_young median_age
                              median_income pct_stem pct_broadband
                              pre_mean_early pre_mean_late pre_median_price
-------------------------------------------------------------------------------
Unless period is specified
predictors are averaged over: 3 4 5 6 7 8 9
-------------------------------------------------------------------------------

Second Step: Run Optimization
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------
Optimization done
-------------------------------------------------------------------------------

Third Step: Obtain Results
-------------------------------------------------------------------------------
Loss: Root Mean Squared Prediction Error

---------------------
   RMSPE |  .0266366 
---------------------
-------------------------------------------------------------------------------
Unit Weights:

-----------------------
    Co_No | Unit_Weight
----------+------------
        1 |           0
        2 |           0
        3 |           0
        4 |           0
        5 |           0
        6 |           0
        7 |           0
        8 |           0
        9 |           0
       10 |           0
       11 |           0
       12 |           0
       13 |           0
       14 |           0
       15 |           0
       16 |           0
       17 |           0
       18 |           0
       20 |           0
       21 |           0
       22 |           0
       23 |           0
       24 |           0
       25 |           0
       27 |           0
       28 |           0
       29 |           0
       30 |           0
       31 |           0
       32 |           0
       33 |           0
       34 |           0
       35 |           0
       36 |           0
       38 |           0
       39 |           0
       41 |           0
       43 |           0
       44 |           0
       45 |           0
       46 |           0
       47 |           0
       48 |           0
       49 |           0
       51 |           0
       52 |           0
       53 |           0
       54 |           0
       55 |           0
       56 |           0
       57 |           0
       58 |           0
       59 |           0
       60 |           0
       61 |           0
       62 |           0
       63 |           0
       64 |           0
       65 |           0
       66 |           0
       67 |           0
       68 |           0
       69 |           0
       70 |           0
       71 |           0
       72 |           0
       73 |           0
       74 |           0
       75 |           0
       77 |           0
       78 |           0
       79 |           0
       80 |           0
       81 |           0
       82 |           0
       83 |           0
       84 |           0
       85 |           0
       86 |           0
       87 |           0
       88 |           0
       89 |           0
       90 |           0
       91 |           0
       92 |           0
       93 |           0
       94 |           0
       95 |           0
       96 |           0
       97 |           0
       99 |           0
      100 |           0
      101 |           0
      102 |           0
      103 |           0
      104 |           0
      106 |           0
      107 |           0
      108 |           0
      109 |           0
      111 |           0
      112 |           0
      113 |           0
      114 |           0
      118 |           0
      120 |           0
      122 |           0
      123 |           0
      124 |           0
      126 |           0
      127 |           0
      128 |           0
      129 |           0
      130 |           0
      131 |           0
      132 |           0
      133 |           0
      134 |           0
      138 |           0
      141 |           0
      142 |           0
      146 |           0
      147 |           0
      148 |           0
      149 |           0
      150 |           0
      152 |           0
      153 |           0
      154 |           0
      155 |           0
      156 |           0
      157 |           0
      158 |           0
      159 |           0
      160 |           0
      161 |           0
      162 |           0
      163 |           0
      164 |           0
      165 |           0
      166 |           0
      167 |           0
      168 |           0
      169 |           0
      170 |           0
      171 |           0
      172 |           0
      173 |           0
      174 |           0
      175 |           0
      176 |           0
      177 |           0
      178 |           0
      179 |           0
      180 |           0
      181 |           0
      182 |           0
      183 |           0
      184 |           0
      185 |           0
      186 |           0
      187 |           0
      188 |           0
      189 |           0
      190 |           0
      191 |           0
      192 |           0
      193 |           0
      194 |           0
      195 |           0
      196 |           0
      197 |           0
      198 |           0
      199 |           0
      200 |           0
      201 |           0
      202 |           0
      203 |           0
      204 |           0
      205 |           0
      206 |           0
      207 |           0
      208 |           0
      209 |           0
      210 |           0
      211 |           0
      212 |           0
      213 |           0
      214 |           0
      215 |           0
      216 |           0
      217 |           0
      218 |           0
      219 |           0
      220 |           0
      221 |           0
      222 |           0
      224 |           0
      228 |           0
      229 |           0
      230 |           0
      237 |           0
      240 |           0
      241 |           0
      242 |           0
      243 |           0
      244 |           0
      245 |           0
      246 |           0
      247 |        .171
      248 |           0
      249 |           0
      250 |           0
      251 |           0
      252 |           0
      253 |           0
      254 |           0
      255 |           0
      256 |           0
      257 |           0
      258 |        .003
      260 |           0
      261 |           0
      262 |           0
      263 |           0
      264 |           0
      265 |           0
      266 |           0
      267 |           0
      268 |           0
      269 |           0
      270 |           0
      271 |           0
      272 |           0
      273 |        .106
      274 |           0
      275 |           0
      276 |           0
      277 |           0
      278 |           0
      279 |           0
      280 |           0
      281 |           0
      282 |           0
      283 |           0
      284 |           0
      285 |           0
      286 |           0
      287 |           0
      288 |           0
      289 |           0
      290 |           0
      291 |           0
      292 |           0
      293 |           0
      294 |           0
      295 |           0
      296 |           0
      297 |           0
      298 |           0
      299 |           0
      300 |           0
      301 |           0
      302 |           0
      303 |           0
      304 |           0
      305 |           0
      306 |           0
      307 |           0
      308 |           0
      309 |           0
      310 |           0
      311 |           0
      312 |           0
      313 |           0
      314 |           0
      315 |           0
      316 |           0
      317 |           0
      318 |           0
      319 |           0
      320 |           0
      321 |           0
      322 |           0
      323 |           0
      324 |           0
      325 |           0
      326 |           0
      327 |           0
      328 |           0
      329 |           0
      331 |           0
      332 |           0
      333 |           0
      334 |           0
      335 |           0
      336 |           0
      337 |           0
      338 |           0
      339 |           0
      340 |           0
      341 |           0
      342 |           0
      343 |           0
      344 |           0
      345 |           0
      346 |           0
      347 |           0
      348 |        .053
      351 |           0
      352 |           0
      353 |           0
      355 |           0
      356 |           0
      357 |           0
      358 |           0
      360 |           0
      362 |           0
      363 |           0
      364 |           0
      365 |           0
      369 |           0
      370 |           0
      373 |           0
      379 |           0
      384 |           0
      385 |           0
      386 |           0
      388 |           0
      389 |           0
      390 |           0
      394 |           0
      395 |           0
      396 |           0
      397 |           0
      398 |           0
      400 |           0
      402 |           0
      403 |           0
      404 |           0
      405 |           0
      406 |           0
      408 |           0
      411 |           0
      412 |           0
      413 |           0
      414 |           0
      415 |           0
      417 |           0
      418 |           0
      419 |           0
      420 |           0
      421 |           0
      423 |           0
      424 |           0
      426 |           0
      428 |           0
      429 |           0
      430 |           0
      431 |           0
      432 |           0
      433 |           0
      434 |           0
      435 |           0
      436 |           0
      437 |           0
      438 |           0
      439 |           0
      440 |           0
      441 |           0
      442 |           0
      444 |           0
      445 |           0
      446 |           0
      447 |           0
      449 |           0
      450 |           0
      451 |           0
      452 |           0
      453 |           0
      454 |           0
      455 |           0
      456 |           0
      457 |           0
      458 |           0
      459 |           0
      462 |           0
      465 |           0
      466 |           0
      467 |           0
      468 |           0
      470 |           0
      471 |           0
      472 |           0
      473 |           0
      474 |           0
      475 |           0
      476 |           0
      477 |           0
      478 |           0
      479 |           0
      480 |           0
      481 |           0
      482 |           0
      484 |           0
      485 |           0
      486 |           0
      487 |           0
      488 |           0
      489 |           0
      490 |           0
      491 |           0
      492 |           0
      493 |           0
      494 |           0
      495 |           0
      496 |           0
      497 |           0
      498 |           0
      500 |           0
      501 |           0
      502 |           0
      503 |           0
      504 |           0
      505 |           0
      506 |           0
      507 |           0
      508 |           0
      509 |           0
      510 |           0
      511 |           0
      512 |           0
      513 |           0
      514 |           0
      515 |           0
      518 |           0
      519 |           0
      520 |           0
      521 |           0
      524 |           0
      525 |           0
      526 |           0
      527 |         .02
      528 |           0
      529 |           0
      530 |           0
      531 |           0
      532 |           0
      534 |           0
      535 |           0
      536 |           0
      537 |           0
      538 |           0
      539 |           0
      540 |           0
      541 |           0
      542 |           0
      543 |           0
      546 |           0
      547 |           0
      549 |           0
      550 |           0
      551 |           0
      552 |           0
      553 |           0
      554 |           0
      555 |           0
      557 |           0
      558 |           0
      559 |           0
      560 |           0
      562 |           0
      563 |           0
      564 |           0
      565 |           0
      566 |           0
      567 |           0
      568 |           0
      571 |           0
      573 |           0
      574 |           0
      575 |           0
      576 |           0
      578 |           0
      579 |           0
      580 |           0
      581 |           0
      583 |           0
      584 |           0
      588 |           0
      589 |           0
      590 |           0
      591 |           0
      592 |           0
      593 |           0
      595 |           0
      596 |           0
      597 |           0
      599 |           0
      601 |           0
      602 |           0
      604 |           0
      605 |           0
      607 |           0
      609 |           0
      610 |           0
      611 |           0
      613 |           0
      614 |           0
      616 |           0
      617 |           0
      619 |           0
      622 |           0
      623 |           0
      624 |           0
      625 |           0
      626 |           0
      627 |           0
      628 |           0
      629 |           0
      630 |           0
      631 |         .01
      633 |           0
      634 |           0
      636 |           0
      638 |           0
      639 |           0
      640 |           0
      641 |           0
      644 |           0
      645 |           0
      646 |           0
      647 |           0
      648 |           0
      649 |           0
      650 |           0
      657 |           0
      658 |           0
      663 |           0
      665 |           0
      666 |           0
      667 |           0
      668 |           0
      669 |           0
      670 |           0
      671 |           0
      673 |           0
      674 |           0
      675 |           0
      676 |           0
      677 |           0
      678 |           0
      679 |           0
      680 |           0
      681 |           0
      683 |           0
      684 |           0
      685 |           0
      686 |           0
      687 |           0
      688 |           0
      689 |           0
      690 |           0
      691 |           0
      692 |           0
      693 |           0
      694 |           0
      695 |           0
      696 |           0
      697 |           0
      698 |           0
      699 |           0
      700 |           0
      701 |           0
      702 |           0
      703 |           0
      705 |           0
      706 |           0
      708 |           0
      709 |           0
      710 |           0
      711 |           0
      712 |           0
      713 |           0
      714 |           0
      715 |        .021
      716 |           0
      717 |           0
      718 |           0
      719 |           0
      720 |           0
      721 |           0
      722 |           0
      723 |           0
      724 |           0
      725 |           0
      726 |           0
      727 |           0
      728 |           0
      729 |           0
      732 |           0
      733 |           0
      734 |           0
      735 |           0
      736 |           0
      737 |           0
      738 |        .107
      740 |           0
      741 |           0
      742 |           0
      743 |           0
      744 |           0
      745 |           0
      746 |           0
      747 |           0
      748 |           0
      749 |           0
      750 |           0
      751 |           0
      752 |           0
      753 |           0
      754 |           0
      755 |           0
      756 |           0
      757 |           0
      758 |           0
      759 |           0
      760 |           0
      761 |           0
      762 |           0
      763 |           0
      764 |           0
      765 |        .047
      766 |           0
      767 |           0
      768 |           0
      769 |           0
      770 |           0
      771 |           0
      772 |           0
      773 |           0
      774 |           0
      775 |           0
      776 |           0
      777 |           0
      779 |           0
      780 |           0
      782 |           0
      783 |           0
      784 |           0
      785 |           0
      786 |        .462
      787 |           0
      788 |           0
      789 |           0
      790 |           0
      791 |           0
      792 |           0
      793 |           0
      794 |           0
      795 |           0
      796 |           0
      797 |           0
      798 |           0
      799 |           0
      800 |           0
      801 |           0
      802 |           0
      803 |           0
      804 |           0
      805 |           0
      806 |           0
      807 |           0
      808 |           0
      809 |           0
      810 |           0
      811 |           0
      812 |           0
      813 |           0
      814 |           0
      815 |           0
      816 |           0
      817 |           0
      818 |           0
      819 |           0
      820 |           0
      821 |           0
      822 |           0
      823 |           0
      824 |           0
      825 |           0
      826 |           0
      827 |           0
      828 |           0
      829 |           0
      830 |           0
      831 |           0
      832 |           0
      833 |           0
      834 |           0
      835 |           0
      836 |           0
      837 |           0
      838 |           0
      839 |           0
      840 |           0
      841 |           0
      842 |           0
      843 |           0
      844 |           0
      845 |           0
      846 |           0
      847 |           0
      848 |           0
      849 |           0
      850 |           0
      851 |           0
      852 |           0
      853 |           0
      855 |           0
      856 |           0
      857 |           0
      858 |           0
      859 |           0
      860 |           0
      861 |           0
      862 |           0
      863 |           0
      864 |           0
      865 |           0
      866 |           0
      867 |           0
      868 |           0
      869 |           0
      870 |           0
      871 |           0
      872 |           0
      873 |           0
-----------------------
-------------------------------------------------------------------------------
Predictor Balance:

------------------------------------------------------
                               |   Treated  Synthetic 
-------------------------------+----------------------
                   pct_college |  .4096401   .4089934 
                   pct_hh_100k |  .3506498   .3502785 
                     pct_young |  .0982783   .0988854 
                    median_age |  35.87647   35.90023 
                 median_income |  73536.99   73574.31 
                      pct_stem |  .4314912   .4316506 
                 pct_broadband |  .8522041    .852162 
                pre_mean_early |  4.767876    4.76698 
                 pre_mean_late |  5.111015   5.110304 
              pre_median_price |  20.07929   20.08638 
------------------------------------------------------
-------------------------------------------------------------------------------

. 
. * The output includes:
. * - Donor weights
. * - Covariate balance table
. * - Pre/post treatment gaps
. 
. * Save results graph
. graph export "`outdir'/chicago_synth_stata.png", replace width(1200)
file /Users/jeffreyohl/Dropbox/LLM_PassThrough/output/unique_users/15to25/all_m
> erchants/chicago_synth_stata.png written in PNG format

. 
. * Display treatment effects
. * synth stores results in e()
. matrix list e(Y_treated)

e(Y_treated)[21,1]
          544
 3  4.4308168
 4  4.7874917
 5  4.8903491
 6  4.9628446
 7   5.049856
 8  5.1298987
 9  5.1532916
10  5.3082677
11  5.3936275
12  5.4847969
13  5.5294291
14  5.6094718
15  5.6664267
16  5.7203118
17  5.7651911
18  5.7807435
19  5.8230459
20  5.8664681
21  5.9348942
22  5.9989366
23  6.1092476

. matrix list e(Y_synthetic)

e(Y_synthetic)[21,1]
           c1
 3    4.45578
 4   4.747359
 5  4.8898323
 6  4.9749499
 7   5.028716
 8   5.108014
 9  5.1941834
10  5.3119055
11  5.3665787
12  5.4832154
13  5.5917774
14  5.6645191
15  5.7536931
16  5.8515447
17  5.8974615
18  5.9695149
19  5.9968777
20  6.0010335
21  6.1513586
22  6.2662716
23  6.3441054

. 
. * ===========================================================================
> ==
. * SAVE DONOR WEIGHTS WITH ZIP3 CODES
. * (Must do this BEFORE any preserve/restore that would clear e() results)
. * ===========================================================================
> ==
. 
. * Get the weight matrix from synth
. matrix W = e(W_weights)

. local nrows = rowsof(W)

. 
. * Build a dataset with unit IDs and weights
. preserve

. clear

. set obs `nrows'
Number of observations (_N) was 0, now 738.

. gen zip3_id = .
(738 missing values generated)

. gen weight = .
(738 missing values generated)

. 
. * Fill in from the matrix - row names are the unit IDs
. local rnames : rowfullnames W

. local i = 1

. foreach rn of local rnames {
  2.     quietly replace zip3_id = `rn' in `i'
  3.     quietly replace weight = W[`i', 1] in `i'
  4.     local ++i
  5. }

. 
. * Keep only positive weights
. keep if weight > 0.001
(0 observations deleted)

. tempfile weights_temp

. save `weights_temp'
file /var/folders/g9/ggrmf_5j6tx4rv5qdhs0slq40000gn/T//St40752.000002 saved
    as .dta format

. restore

. 
. * Merge with main data to get ZIP3 codes
. preserve

. keep zip3_id zip3

. duplicates drop

Duplicates in terms of all variables

(14,780 observations deleted)

. merge 1:1 zip3_id using `weights_temp', keep(match) nogen
(variable zip3_id was long, now double to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                               738  
    -----------------------------------------

. 
. * Sort by weight descending
. gsort -weight

. 
. * Display top donors
. list zip3 zip3_id weight, sep(0)

     +-------------------------+
     | zip3   zip3_id   weight |
     |-------------------------|
  1. |  999       873      873 |
  2. |  998       872      872 |
  3. |  997       871      871 |
  4. |  996       870      870 |
  5. |  995       869      869 |
  6. |  994       868      868 |
  7. |  993       867      867 |
  8. |  992       866      866 |
  9. |  991       865      865 |
 10. |  990       864      864 |
 11. |  989       863      863 |
 12. |  988       862      862 |
 13. |  986       861      861 |
 14. |  985       860      860 |
 15. |  984       859      859 |
 16. |  983       858      858 |
 17. |  982       857      857 |
 18. |  981       856      856 |
 19. |  980       855      855 |
 20. |  978       853      853 |
 21. |  977       852      852 |
 22. |  976       851      851 |
 23. |  975       850      850 |
 24. |  974       849      849 |
 25. |  973       848      848 |
 26. |  972       847      847 |
 27. |  971       846      846 |
 28. |  970       845      845 |
 29. |  968       844      844 |
 30. |  967       843      843 |
 31. |  961       842      842 |
 32. |  960       841      841 |
 33. |  959       840      840 |
 34. |  958       839      839 |
 35. |  957       838      838 |
 36. |  956       837      837 |
 37. |  955       836      836 |
 38. |  954       835      835 |
 39. |  953       834      834 |
 40. |  952       833      833 |
 41. |  951       832      832 |
 42. |  950       831      831 |
 43. |  949       830      830 |
 44. |  948       829      829 |
 45. |  947       828      828 |
 46. |  946       827      827 |
 47. |  945       826      826 |
 48. |  944       825      825 |
 49. |  943       824      824 |
 50. |  941       823      823 |
 51. |  940       822      822 |
 52. |  939       821      821 |
 53. |  937       820      820 |
 54. |  936       819      819 |
 55. |  935       818      818 |
 56. |  934       817      817 |
 57. |  933       816      816 |
 58. |  932       815      815 |
 59. |  931       814      814 |
 60. |  930       813      813 |
 61. |  928       812      812 |
 62. |  927       811      811 |
 63. |  926       810      810 |
 64. |  925       809      809 |
 65. |  924       808      808 |
 66. |  923       807      807 |
 67. |  922       806      806 |
 68. |  921       805      805 |
 69. |  920       804      804 |
 70. |  919       803      803 |
 71. |  918       802      802 |
 72. |  917       801      801 |
 73. |  916       800      800 |
 74. |  915       799      799 |
 75. |  914       798      798 |
 76. |  913       797      797 |
 77. |  912       796      796 |
 78. |  911       795      795 |
 79. |  910       794      794 |
 80. |  908       793      793 |
 81. |  907       792      792 |
 82. |  906       791      791 |
 83. |  905       790      790 |
 84. |  904       789      789 |
 85. |  903       788      788 |
 86. |  902       787      787 |
 87. |  900       786      786 |
 88. |  898       785      785 |
 89. |  897       784      784 |
 90. |  895       783      783 |
 91. |  894       782      782 |
 92. |  891       780      780 |
 93. |  890       779      779 |
 94. |  883       777      777 |
 95. |  882       776      776 |
 96. |  881       775      775 |
 97. |  880       774      774 |
 98. |  879       773      773 |
 99. |  878       772      772 |
100. |  877       771      771 |
101. |  875       770      770 |
102. |  874       769      769 |
103. |  873       768      768 |
104. |  871       767      767 |
105. |  870       766      766 |
106. |  865       765      765 |
107. |  864       764      764 |
108. |  863       763      763 |
109. |  860       762      762 |
110. |  859       761      761 |
111. |  857       760      760 |
112. |  856       759      759 |
113. |  855       758      758 |
114. |  853       757      757 |
115. |  852       756      756 |
116. |  851       755      755 |
117. |  850       754      754 |
118. |  847       753      753 |
119. |  846       752      752 |
120. |  845       751      751 |
121. |  844       750      750 |
122. |  843       749      749 |
123. |  841       748      748 |
124. |  840       747      747 |
125. |  838       746      746 |
126. |  837       745      745 |
127. |  836       744      744 |
128. |  835       743      743 |
129. |  834       742      742 |
130. |  833       741      741 |
131. |  832       740      740 |
132. |  830       738      738 |
133. |  829       737      737 |
134. |  828       736      736 |
135. |  827       735      735 |
136. |  826       734      734 |
137. |  825       733      733 |
138. |  824       732      732 |
139. |  820       729      729 |
140. |  816       728      728 |
141. |  815       727      727 |
142. |  814       726      726 |
143. |  813       725      725 |
144. |  812       724      724 |
145. |  811       723      723 |
146. |  810       722      722 |
147. |  809       721      721 |
148. |  808       720      720 |
149. |  807       719      719 |
150. |  806       718      718 |
151. |  805       717      717 |
152. |  804       716      716 |
153. |  803       715      715 |
154. |  802       714      714 |
155. |  801       713      713 |
156. |  800       712      712 |
157. |  799       711      711 |
158. |  798       710      710 |
159. |  797       709      709 |
160. |  796       708      708 |
161. |  794       706      706 |
162. |  793       705      705 |
163. |  791       703      703 |
164. |  790       702      702 |
165. |  789       701      701 |
166. |  788       700      700 |
167. |  787       699      699 |
168. |  786       698      698 |
169. |  785       697      697 |
170. |  784       696      696 |
171. |  783       695      695 |
172. |  782       694      694 |
173. |  781       693      693 |
174. |  780       692      692 |
175. |  779       691      691 |
176. |  778       690      690 |
177. |  777       689      689 |
178. |  776       688      688 |
179. |  775       687      687 |
180. |  774       686      686 |
181. |  773       685      685 |
182. |  770       684      684 |
183. |  769       683      683 |
184. |  767       681      681 |
185. |  766       680      680 |
186. |  765       679      679 |
187. |  764       678      678 |
188. |  763       677      677 |
189. |  762       676      676 |
190. |  761       675      675 |
191. |  760       674      674 |
192. |  759       673      673 |
193. |  757       671      671 |
194. |  756       670      670 |
195. |  755       669      669 |
196. |  754       668      668 |
197. |  752       667      667 |
198. |  751       666      666 |
199. |  750       665      665 |
200. |  748       663      663 |
201. |  741       658      658 |
202. |  740       657      657 |
203. |  731       650      650 |
204. |  730       649      649 |
205. |  729       648      648 |
206. |  728       647      647 |
207. |  727       646      646 |
208. |  726       645      645 |
209. |  725       644      644 |
210. |  722       641      641 |
211. |  721       640      640 |
212. |  720       639      639 |
213. |  719       638      638 |
214. |  717       636      636 |
215. |  714       634      634 |
216. |  713       633      633 |
217. |  711       631      631 |
218. |  710       630      630 |
219. |  708       629      629 |
220. |  707       628      628 |
221. |  706       627      627 |
222. |  705       626      626 |
223. |  704       625      625 |
224. |  703       624      624 |
225. |  701       623      623 |
226. |  700       622      622 |
227. |  691       619      619 |
228. |  689       617      617 |
229. |  688       616      616 |
230. |  686       614      614 |
231. |  685       613      613 |
232. |  683       611      611 |
233. |  681       610      610 |
234. |  680       609      609 |
235. |  678       607      607 |
236. |  676       605      605 |
237. |  675       604      604 |
238. |  673       602      602 |
239. |  672       601      601 |
240. |  670       599      599 |
241. |  667       597      597 |
242. |  666       596      596 |
243. |  665       595      595 |
244. |  662       593      593 |
245. |  661       592      592 |
246. |  660       591      591 |
247. |  658       590      590 |
248. |  657       589      589 |
249. |  656       588      588 |
250. |  652       584      584 |
251. |  651       583      583 |
252. |  648       581      581 |
253. |  647       580      580 |
254. |  646       579      579 |
255. |  645       578      578 |
256. |  641       576      576 |
257. |  640       575      575 |
258. |  639       574      574 |
259. |  638       573      573 |
260. |  636       571      571 |
261. |  633       568      568 |
262. |  631       567      567 |
263. |  630       566      566 |
264. |  629       565      565 |
265. |  628       564      564 |
266. |  627       563      563 |
267. |  626       562      562 |
268. |  624       560      560 |
269. |  623       559      559 |
270. |  622       558      558 |
271. |  620       557      557 |
272. |  618       555      555 |
273. |  617       554      554 |
274. |  616       553      553 |
275. |  615       552      552 |
276. |  614       551      551 |
277. |  613       550      550 |
278. |  612       549      549 |
279. |  610       547      547 |
280. |  609       546      546 |
281. |  605       543      543 |
282. |  604       542      542 |
283. |  603       541      541 |
284. |  602       540      540 |
285. |  601       539      539 |
286. |  600       538      538 |
287. |  599       537      537 |
288. |  598       536      536 |
289. |  597       535      535 |
290. |  596       534      534 |
291. |  594       532      532 |
292. |  593       531      531 |
293. |  592       530      530 |
294. |  591       529      529 |
295. |  590       528      528 |
296. |  588       527      527 |
297. |  587       526      526 |
298. |  586       525      525 |
299. |  585       524      524 |
300. |  582       521      521 |
301. |  581       520      520 |
302. |  580       519      519 |
303. |  577       518      518 |
304. |  574       515      515 |
305. |  573       514      514 |
306. |  572       513      513 |
307. |  571       512      512 |
308. |  570       511      511 |
309. |  567       510      510 |
310. |  566       509      509 |
311. |  565       508      508 |
312. |  564       507      507 |
313. |  563       506      506 |
314. |  562       505      505 |
315. |  561       504      504 |
316. |  560       503      503 |
317. |  559       502      502 |
318. |  558       501      501 |
319. |  557       500      500 |
320. |  554       498      498 |
321. |  553       497      497 |
322. |  551       496      496 |
323. |  550       495      495 |
324. |  549       494      494 |
325. |  548       493      493 |
326. |  547       492      492 |
327. |  546       491      491 |
328. |  545       490      490 |
329. |  544       489      489 |
330. |  543       488      488 |
331. |  542       487      487 |
332. |  541       486      486 |
333. |  540       485      485 |
334. |  539       484      484 |
335. |  537       482      482 |
336. |  535       481      481 |
337. |  534       480      480 |
338. |  532       479      479 |
339. |  531       478      478 |
340. |  530       477      477 |
341. |  528       476      476 |
342. |  527       475      475 |
343. |  526       474      474 |
344. |  525       473      473 |
345. |  524       472      472 |
346. |  523       471      471 |
347. |  522       470      470 |
348. |  520       468      468 |
349. |  516       467      467 |
350. |  515       466      466 |
351. |  514       465      465 |
352. |  511       462      462 |
353. |  507       459      459 |
354. |  506       458      458 |
355. |  505       457      457 |
356. |  504       456      456 |
357. |  503       455      455 |
358. |  502       454      454 |
359. |  501       453      453 |
360. |  500       452      452 |
361. |  499       451      451 |
362. |  498       450      450 |
363. |  497       449      449 |
364. |  495       447      447 |
365. |  494       446      446 |
366. |  493       445      445 |
367. |  492       444      444 |
368. |  490       442      442 |
369. |  489       441      441 |
370. |  488       440      440 |
371. |  487       439      439 |
372. |  486       438      438 |
373. |  485       437      437 |
374. |  484       436      436 |
375. |  483       435      435 |
376. |  482       434      434 |
377. |  481       433      433 |
378. |  480       432      432 |
379. |  479       431      431 |
380. |  478       430      430 |
381. |  477       429      429 |
382. |  476       428      428 |
383. |  474       426      426 |
384. |  472       424      424 |
385. |  471       423      423 |
386. |  469       421      421 |
387. |  468       420      420 |
388. |  467       419      419 |
389. |  466       418      418 |
390. |  465       417      417 |
391. |  463       415      415 |
392. |  462       414      414 |
393. |  461       413      413 |
394. |  460       412      412 |
395. |  458       411      411 |
396. |  454       408      408 |
397. |  452       406      406 |
398. |  451       405      405 |
399. |  450       404      404 |
400. |  449       403      403 |
401. |  448       402      402 |
402. |  446       400      400 |
403. |  444       398      398 |
404. |  443       397      397 |
405. |  442       396      396 |
406. |  441       395      395 |
407. |  440       394      394 |
408. |  436       390      390 |
409. |  435       389      389 |
410. |  434       388      388 |
411. |  432       386      386 |
412. |  431       385      385 |
413. |  430       384      384 |
414. |  423       379      379 |
415. |  413       373      373 |
416. |  410       370      370 |
417. |  409       369      369 |
418. |  405       365      365 |
419. |  404       364      364 |
420. |  403       363      363 |
421. |  402       362      362 |
422. |  400       360      360 |
423. |  397       358      358 |
424. |  396       357      357 |
425. |  395       356      356 |
426. |  394       355      355 |
427. |  392       353      353 |
428. |  391       352      352 |
429. |  390       351      351 |
430. |  387       348      348 |
431. |  386       347      347 |
432. |  385       346      346 |
433. |  384       345      345 |
434. |  383       344      344 |
435. |  382       343      343 |
436. |  381       342      342 |
437. |  380       341      341 |
438. |  379       340      340 |
439. |  378       339      339 |
440. |  377       338      338 |
441. |  376       337      337 |
442. |  374       336      336 |
443. |  373       335      335 |
444. |  372       334      334 |
445. |  371       333      333 |
446. |  370       332      332 |
447. |  368       331      331 |
448. |  366       329      329 |
449. |  365       328      328 |
450. |  364       327      327 |
451. |  363       326      326 |
452. |  362       325      325 |
453. |  361       324      324 |
454. |  360       323      323 |
455. |  359       322      322 |
456. |  358       321      321 |
457. |  357       320      320 |
458. |  356       319      319 |
459. |  355       318      318 |
460. |  354       317      317 |
461. |  352       316      316 |
462. |  351       315      315 |
463. |  350       314      314 |
464. |  349       313      313 |
465. |  347       312      312 |
466. |  346       311      311 |
467. |  344       310      310 |
468. |  342       309      309 |
469. |  341       308      308 |
470. |  339       307      307 |
471. |  338       306      306 |
472. |  337       305      305 |
473. |  336       304      304 |
474. |  335       303      303 |
475. |  334       302      302 |
476. |  333       301      301 |
477. |  331       300      300 |
478. |  330       299      299 |
479. |  329       298      298 |
480. |  328       297      297 |
481. |  327       296      296 |
482. |  326       295      295 |
483. |  325       294      294 |
484. |  324       293      293 |
485. |  323       292      292 |
486. |  322       291      291 |
487. |  321       290      290 |
488. |  320       289      289 |
489. |  319       288      288 |
490. |  318       287      287 |
491. |  317       286      286 |
492. |  316       285      285 |
493. |  315       284      284 |
494. |  314       283      283 |
495. |  313       282      282 |
496. |  312       281      281 |
497. |  310       280      280 |
498. |  309       279      279 |
499. |  308       278      278 |
500. |  307       277      277 |
501. |  306       276      276 |
502. |  305       275      275 |
503. |  304       274      274 |
504. |  303       273      273 |
505. |  302       272      272 |
506. |  301       271      271 |
507. |  300       270      270 |
508. |  299       269      269 |
509. |  298       268      268 |
510. |  297       267      267 |
511. |  296       266      266 |
512. |  295       265      265 |
513. |  294       264      264 |
514. |  293       263      263 |
515. |  292       262      262 |
516. |  291       261      261 |
517. |  290       260      260 |
518. |  288       258      258 |
519. |  287       257      257 |
520. |  286       256      256 |
521. |  285       255      255 |
522. |  284       254      254 |
523. |  283       253      253 |
524. |  282       252      252 |
525. |  281       251      251 |
526. |  280       250      250 |
527. |  279       249      249 |
528. |  278       248      248 |
529. |  277       247      247 |
530. |  276       246      246 |
531. |  275       245      245 |
532. |  274       244      244 |
533. |  273       243      243 |
534. |  272       242      242 |
535. |  271       241      241 |
536. |  270       240      240 |
537. |  265       237      237 |
538. |  257       230      230 |
539. |  255       229      229 |
540. |  254       228      228 |
541. |  249       224      224 |
542. |  246       222      222 |
543. |  245       221      221 |
544. |  244       220      220 |
545. |  243       219      219 |
546. |  242       218      218 |
547. |  241       217      217 |
548. |  240       216      216 |
549. |  239       215      215 |
550. |  238       214      214 |
551. |  237       213      213 |
552. |  236       212      212 |
553. |  235       211      211 |
554. |  234       210      210 |
555. |  233       209      209 |
556. |  232       208      208 |
557. |  231       207      207 |
558. |  230       206      206 |
559. |  229       205      205 |
560. |  228       204      204 |
561. |  227       203      203 |
562. |  226       202      202 |
563. |  225       201      201 |
564. |  224       200      200 |
565. |  223       199      199 |
566. |  222       198      198 |
567. |  221       197      197 |
568. |  220       196      196 |
569. |  219       195      195 |
570. |  218       194      194 |
571. |  217       193      193 |
572. |  216       192      192 |
573. |  215       191      191 |
574. |  214       190      190 |
575. |  212       189      189 |
576. |  211       188      188 |
577. |  210       187      187 |
578. |  209       186      186 |
579. |  208       185      185 |
580. |  207       184      184 |
581. |  206       183      183 |
582. |  201       182      182 |
583. |  200       181      181 |
584. |  199       180      180 |
585. |  198       179      179 |
586. |  197       178      178 |
587. |  196       177      177 |
588. |  195       176      176 |
589. |  194       175      175 |
590. |  193       174      174 |
591. |  191       173      173 |
592. |  190       172      172 |
593. |  189       171      171 |
594. |  188       170      170 |
595. |  187       169      169 |
596. |  186       168      168 |
597. |  185       167      167 |
598. |  184       166      166 |
599. |  183       165      165 |
600. |  182       164      164 |
601. |  181       163      163 |
602. |  180       162      162 |
603. |  179       161      161 |
604. |  178       160      160 |
605. |  177       159      159 |
606. |  176       158      158 |
607. |  175       157      157 |
608. |  174       156      156 |
609. |  173       155      155 |
610. |  172       154      154 |
611. |  171       153      153 |
612. |  170       152      152 |
613. |  168       150      150 |
614. |  167       149      149 |
615. |  166       148      148 |
616. |  165       147      147 |
617. |  164       146      146 |
618. |  160       142      142 |
619. |  159       141      141 |
620. |  156       138      138 |
621. |  152       134      134 |
622. |  151       133      133 |
623. |  150       132      132 |
624. |  149       131      131 |
625. |  148       130      130 |
626. |  147       129      129 |
627. |  146       128      128 |
628. |  145       127      127 |
629. |  144       126      126 |
630. |  142       124      124 |
631. |  141       123      123 |
632. |  140       122      122 |
633. |  138       120      120 |
634. |  136       118      118 |
635. |  132       114      114 |
636. |  131       113      113 |
637. |  130       112      112 |
638. |  129       111      111 |
639. |  127       109      109 |
640. |  126       108      108 |
641. |  125       107      107 |
642. |  124       106      106 |
643. |  122       104      104 |
644. |  121       103      103 |
645. |  120       102      102 |
646. |  119       101      101 |
647. |  118       100      100 |
648. |  117        99       99 |
649. |  115        97       97 |
650. |  114        96       96 |
651. |  113        95       95 |
652. |  112        94       94 |
653. |  111        93       93 |
654. |  110        92       92 |
655. |  109        91       91 |
656. |  108        90       90 |
657. |  107        89       89 |
658. |  106        88       88 |
659. |  105        87       87 |
660. |  104        86       86 |
661. |  103        85       85 |
662. |  102        84       84 |
663. |  101        83       83 |
664. |  100        82       82 |
665. |  089        81       81 |
666. |  088        80       80 |
667. |  087        79       79 |
668. |  086        78       78 |
669. |  085        77       77 |
670. |  083        75       75 |
671. |  082        74       74 |
672. |  081        73       73 |
673. |  080        72       72 |
674. |  079        71       71 |
675. |  078        70       70 |
676. |  077        69       69 |
677. |  076        68       68 |
678. |  075        67       67 |
679. |  074        66       66 |
680. |  073        65       65 |
681. |  072        64       64 |
682. |  071        63       63 |
683. |  070        62       62 |
684. |  069        61       61 |
685. |  068        60       60 |
686. |  067        59       59 |
687. |  066        58       58 |
688. |  065        57       57 |
689. |  064        56       56 |
690. |  063        55       55 |
691. |  062        54       54 |
692. |  061        53       53 |
693. |  060        52       52 |
694. |  058        51       51 |
695. |  056        49       49 |
696. |  054        48       48 |
697. |  053        47       47 |
698. |  052        46       46 |
699. |  051        45       45 |
700. |  050        44       44 |
701. |  049        43       43 |
702. |  047        41       41 |
703. |  045        39       39 |
704. |  044        38       38 |
705. |  042        36       36 |
706. |  041        35       35 |
707. |  040        34       34 |
708. |  039        33       33 |
709. |  038        32       32 |
710. |  037        31       31 |
711. |  036        30       30 |
712. |  035        29       29 |
713. |  034        28       28 |
714. |  033        27       27 |
715. |  031        25       25 |
716. |  030        24       24 |
717. |  029        23       23 |
718. |  028        22       22 |
719. |  027        21       21 |
720. |  026        20       20 |
721. |  024        18       18 |
722. |  023        17       17 |
723. |  022        16       16 |
724. |  021        15       15 |
725. |  020        14       14 |
726. |  019        13       13 |
727. |  018        12       12 |
728. |  017        11       11 |
729. |  016        10       10 |
730. |  015         9        9 |
731. |  014         8        8 |
732. |  013         7        7 |
733. |  012         6        6 |
734. |  011         5        5 |
735. |  010         4        4 |
736. |  009         3        3 |
737. |  007         2        2 |
738. |  006         1        1 |
     +-------------------------+

. 
. * Save to CSV
. export delimited zip3 zip3_id weight using "`outdir'/synth_donor_weights.csv"
> , replace
file /Users/jeffreyohl/Dropbox/LLM_PassThrough/output/unique_users/15to25/all_m
> erchants/synth_donor_weights.csv saved

. display "Saved donor weights to `outdir'/synth_donor_weights.csv"
Saved donor weights to /Users/jeffreyohl/Dropbox/LLM_PassThrough/output/unique_
> users/15to25/all_merchants/synth_donor_weights.csv

. 
. restore

. 
. * ===========================================================================
> ==
. * COMPUTE AVERAGE TREATMENT GAPS
. * ===========================================================================
> ==
. preserve

. use "`outdir'/synth_results.dta", clear

. gen gap = _Y_treated - _Y_synthetic
(717 missing values generated)

. summarize gap if _time >= `treatment_time'

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         gap |         14   -.1184999    .0923412   -.267335   .0270488

. local post_gap = r(mean)

. display "Average post-treatment gap: `post_gap'"
Average post-treatment gap: -.1184998924228629

. summarize gap if _time < `treatment_time'

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         gap |          7    .0008163    .0287921  -.0408918   .0401327

. local pre_gap = r(mean)

. display "Average pre-treatment gap: `pre_gap'"
Average pre-treatment gap: .0008162869073983

. restore

. 
end of do-file
